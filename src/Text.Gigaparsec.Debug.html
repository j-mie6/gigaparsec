<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Trustworthy #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ExistentialQuantification, NamedFieldPuns #-}</span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{-|
Module      : Text.Gigaparsec.Debug
Description : This module contains the very useful debugging combinator, as well as breakpoints.
License     : BSD-3-Clause
Maintainer  : Jamie Willis, Gigaparsec Maintainers
Stability   : stable

This module contains the very useful debugging combinators 'debug' and 'debugWith', as well as
breakpoints that can be used to pause parsing execution.

@since 0.2.1.0
-}</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Text.Gigaparsec.Debug</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Debug.html#debug"><span class="hs-identifier">debug</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#debugWith"><span class="hs-identifier">debugWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#debugConfig"><span class="hs-identifier">debugConfig</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier">DebugConfig</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier">WatchedReg</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier">Break</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-16"></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html"><span class="hs-identifier">Text.Gigaparsec.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier">Parsec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html"><span class="hs-identifier">Text.Gigaparsec.Internal.RT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html#Reg"><span class="hs-identifier">Reg</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html#readReg"><span class="hs-identifier">readReg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html"><span class="hs-identifier">Text.Gigaparsec.Internal</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Internal</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html"><span class="hs-identifier">Text.Gigaparsec.Internal.RT</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Internal</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">when</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">forM</span></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.IO</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">hGetEcho</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hSetEcho</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">hPutStr</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stdin</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">stdout</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Handle</span></span><span class="hs-special">)</span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">intercalate</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">isPrefixOf</span></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">(:|)</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-operator">(&lt;|)</span></span><span class="hs-special">)</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Console.Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">color</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">supportsPretty</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Color</span></span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Green</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">White</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Red</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Blue</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>
</span><span id="line-29"></span><span class="annot"><span class="hs-comment">{-|
Configuration that allows for customising the behaviour of a 'debugWith'
combinator.
-}</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-34"></span><span class="hs-keyword">data</span><span> </span><span id="DebugConfig"><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-var">DebugConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DebugConfig"><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-var">DebugConfig</span></a></span></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-35"></span><span>    </span><span id="ascii"><span class="annot"><span class="annottext">DebugConfig -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#ascii"><span class="hs-identifier hs-var hs-var">ascii</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- ^ should the output of the combinator be in plain uncoloured ascii?</span></span><span>
</span><span id="line-36"></span><span>    </span><span id="breakPoint"><span class="annot"><span class="annottext">DebugConfig -&gt; Break
</span><a href="Text.Gigaparsec.Debug.html#breakPoint"><span class="hs-identifier hs-var hs-var">breakPoint</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier hs-type">Break</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- ^ should parsing execution be paused when entering or leaving this combinator?</span></span><span>
</span><span id="line-37"></span><span>    </span><span id="watchedRegs"><span class="annot"><span class="annottext">DebugConfig -&gt; [WatchedReg]
</span><a href="Text.Gigaparsec.Debug.html#watchedRegs"><span class="hs-identifier hs-var hs-var">watchedRegs</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="hs-special">[</span><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier hs-type">WatchedReg</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- ^ what registers should have their values tracked during debugging?</span></span><span>
</span><span id="line-38"></span><span>    </span><span id="handle"><span class="annot"><span class="annottext">DebugConfig -&gt; Handle
</span><a href="Text.Gigaparsec.Debug.html#handle"><span class="hs-identifier hs-var hs-var">handle</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ where should the output of the combinator be sent?</span></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-40"></span><span>
</span><span id="line-41"></span><span class="annot"><span class="hs-comment">{-|
The plain configuration used by the 'debug' combinator itself. It will have coloured
terminal output (if available), never pause the parsing execution, not track any registers,
and print its output to 'stdout'.
-}</span></span><span>
</span><span id="line-46"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#debugConfig"><span class="hs-identifier hs-type">debugConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span>
</span><span id="line-47"></span><span id="debugConfig"><span class="annot"><span class="annottext">debugConfig :: DebugConfig
</span><a href="Text.Gigaparsec.Debug.html#debugConfig"><span class="hs-identifier hs-var hs-var">debugConfig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">ascii :: Bool
</span><a href="Text.Gigaparsec.Debug.html#ascii"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">breakPoint :: Break
</span><a href="Text.Gigaparsec.Debug.html#breakPoint"><span class="hs-identifier hs-var">breakPoint</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Break
</span><a href="Text.Gigaparsec.Debug.html#Never"><span class="hs-identifier hs-var">Never</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">watchedRegs :: [WatchedReg]
</span><a href="Text.Gigaparsec.Debug.html#watchedRegs"><span class="hs-identifier hs-var">watchedRegs</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">handle :: Handle
</span><a href="Text.Gigaparsec.Debug.html#handle"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdout</span></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="annot"><span class="hs-comment">{-|
This type allows for a specified register to be watched by a debug combinator. The
contents of the register must be 'Show'able, and it should be given a name to identify
it within the print-out. Registers containing different types can be simultaneously
tracked, which is why this datatype is existential.
-}</span></span><span>
</span><span id="line-55"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier hs-type">WatchedReg</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-56"></span><span class="hs-keyword">data</span><span> </span><span id="WatchedReg"><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier hs-var">WatchedReg</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679238470"><span class="annot"><a href="#local-6989586621679238470"><span class="hs-identifier hs-type">r</span></a></span></span><span> </span><span id="local-6989586621679238471"><span class="annot"><a href="#local-6989586621679238471"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679238471"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span id="WatchedReg"><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier hs-var">WatchedReg</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ the name of the register</span></span><span>
</span><span id="line-57"></span><span>                                                   </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html#Reg"><span class="hs-identifier hs-type">Reg</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238470"><span class="hs-identifier hs-type">r</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238471"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ the register itself</span></span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="annot"><span class="hs-comment">{-|
This is used by 'DebugConfig' to specify whether the parsing should be paused
when passing through a 'debugWith' combinator.
-}</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier hs-type">Break</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="Break"><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier hs-var">Break</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="OnEntry"><span class="annot"><a href="Text.Gigaparsec.Debug.html#OnEntry"><span class="hs-identifier hs-var">OnEntry</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ pause the parsing just after entering a debug combinator</span></span><span>
</span><span id="line-65"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="OnExit"><span class="annot"><a href="Text.Gigaparsec.Debug.html#OnExit"><span class="hs-identifier hs-var">OnExit</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ pause the parsing just after leaving a debug combinator</span></span><span>
</span><span id="line-66"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="Always"><span class="annot"><a href="Text.Gigaparsec.Debug.html#Always"><span class="hs-identifier hs-var">Always</span></a></span></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ pause the parsing both just after entry and exit of a debug combinator</span></span><span>
</span><span id="line-67"></span><span>           </span><span class="hs-glyph">|</span><span> </span><span id="Never"><span class="annot"><a href="Text.Gigaparsec.Debug.html#Never"><span class="hs-identifier hs-var">Never</span></a></span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ do not pause execution when passing through (__default__)</span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">{-|
This combinator allows this parser to be debugged by providing a trace through the execution.

When this combinator is entered, it will print the name assigned to the parser to the console,
as well as the current input context for a few characters that follow.
This parser is then executed. If it succeeded, this combinator again reports the
name along with \&quot;@Good@\&quot; and the input context. If it failed, it reports the name
along with \&quot;@Bad@\&quot; and the input context.
-}</span></span><span>
</span><span id="line-78"></span><span id="local-6989586621679238365"><span class="annot"><a href="Text.Gigaparsec.Debug.html#debug"><span class="hs-identifier hs-type">debug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238365"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238365"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-79"></span><span id="debug"><span class="annot"><span class="annottext">debug :: forall a. String -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Debug.html#debug"><span class="hs-identifier hs-var hs-var">debug</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DebugConfig -&gt; String -&gt; Parsec a -&gt; Parsec a
forall a. DebugConfig -&gt; String -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Debug.html#debugWith"><span class="hs-identifier hs-var">debugWith</span></a></span><span> </span><span class="annot"><span class="annottext">DebugConfig
</span><a href="Text.Gigaparsec.Debug.html#debugConfig"><span class="hs-identifier hs-var">debugConfig</span></a></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="annot"><span class="hs-comment">{-|
This combinator allows this parser to be debugged by providing a trace through the execution.
An additional 'DebugConfig' is provided to customise behaviour.

When this combinator is entered, it will print the name assigned to the parser to the
configured handle, as well as the current input context for a few characters that follow.
This parser is then executed. If it succeeded, this combinator again reports the
name along with \&quot;@Good@\&quot; and the input context. If it failed, it reports the name
along with \&quot;@Bad@\&quot; and the input context.

When breakpoints are enabled within the config, the execution of the combinator will pause
on either entry, exit, or both. The parse is resumed by entering any character on standard input.
-}</span></span><span>
</span><span id="line-94"></span><span id="local-6989586621679238368"><span class="annot"><a href="Text.Gigaparsec.Debug.html#debugWith"><span class="hs-identifier hs-type">debugWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238368"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238368"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-95"></span><span id="debugWith"><span class="annot"><span class="annottext">debugWith :: forall a. DebugConfig -&gt; String -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Debug.html#debugWith"><span class="hs-identifier hs-var hs-var">debugWith</span></a></span></span><span> </span><span id="local-6989586621679238476"><span class="annot"><span class="annottext">config :: DebugConfig
</span><a href="#local-6989586621679238476"><span class="hs-identifier hs-var">config</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679238477"><span class="annot"><span class="annottext">Bool
ascii :: DebugConfig -&gt; Bool
ascii :: Bool
</span><a href="Text.Gigaparsec.Debug.html#ascii"><span class="hs-identifier hs-var hs-var">ascii</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679238478"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238478"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Internal.Parsec</span></a></span><span> </span><span id="local-6989586621679238480"><span class="annot"><span class="annottext">forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679238480"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a.
(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-var">Internal.Parsec</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
 -&gt; Parsec a)
-&gt; (forall r.
    State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679238486"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238486"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679238487"><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238487"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span id="local-6989586621679238488"><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238488"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">-- TODO: could make it so the postamble can print input information from the entry?</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679238489"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238489"><span class="hs-identifier hs-var">ascii'</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679238490"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238490"><span class="hs-identifier hs-var">colourful</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238477"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">||</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238490"><span class="hs-identifier hs-var">colourful</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; RT Bool -&gt; RT Bool
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; RT Bool
forall a. IO a -&gt; RT a
</span><a href="Text.Gigaparsec.Internal.RT.html#unsafeIOToRT"><span class="hs-identifier hs-var">Internal.unsafeIOToRT</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><span class="hs-identifier hs-var">supportsPretty</span></span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238495"><span class="annot"><span class="annottext">config' :: DebugConfig
</span><a href="#local-6989586621679238495"><span class="hs-identifier hs-var hs-var">config'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DebugConfig
</span><a href="#local-6989586621679238476"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#ascii"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679238489"><span class="hs-identifier hs-type">ascii'</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-99"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; Direction -&gt; State -&gt; String -&gt; DebugConfig -&gt; RT ()
</span><a href="Text.Gigaparsec.Debug.html#doDebug"><span class="hs-identifier hs-var">doDebug</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238478"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Enter"><span class="hs-identifier hs-var">Enter</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238486"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span>  </span><span class="annot"><span class="annottext">DebugConfig
</span><a href="#local-6989586621679238495"><span class="hs-identifier hs-var">config'</span></a></span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238499"><span class="annot"><span class="annottext">good' :: a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238499"><span class="hs-identifier hs-var hs-var">good'</span></a></span></span><span> </span><span id="local-6989586621679238500"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679238500"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679238501"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238501"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-101"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238504"><span class="annot"><span class="annottext">st'' :: State
</span><a href="#local-6989586621679238504"><span class="hs-identifier hs-var hs-var">st''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238501"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238501"><span class="hs-identifier hs-type">st'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">}</span><span>
</span><span id="line-102"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Direction -&gt; State -&gt; String -&gt; DebugConfig -&gt; RT ()
</span><a href="Text.Gigaparsec.Debug.html#doDebug"><span class="hs-identifier hs-var">doDebug</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238478"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238504"><span class="hs-identifier hs-var">st''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#green"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238489"><span class="hs-identifier hs-var">ascii'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Good&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DebugConfig
</span><a href="#local-6989586621679238495"><span class="hs-identifier hs-var">config'</span></a></span><span>
</span><span id="line-103"></span><span>        </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238487"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679238500"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238504"><span class="hs-identifier hs-var">st''</span></a></span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238509"><span class="annot"><span class="annottext">bad' :: Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238509"><span class="hs-identifier hs-var hs-var">bad'</span></a></span></span><span> </span><span id="local-6989586621679238510"><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679238510"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679238511"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238511"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-105"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238514"><span class="annot"><span class="annottext">st'' :: State
</span><a href="#local-6989586621679238514"><span class="hs-identifier hs-var hs-var">st''</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238511"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238511"><span class="hs-identifier hs-type">st'</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">-</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">}</span><span>
</span><span id="line-106"></span><span>        </span><span class="annot"><span class="annottext">String -&gt; Direction -&gt; State -&gt; String -&gt; DebugConfig -&gt; RT ()
</span><a href="Text.Gigaparsec.Debug.html#doDebug"><span class="hs-identifier hs-var">doDebug</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238478"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238514"><span class="hs-identifier hs-var">st''</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#red"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238489"><span class="hs-identifier hs-var">ascii'</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; Bad&quot;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">DebugConfig
</span><a href="#local-6989586621679238495"><span class="hs-identifier hs-var">config'</span></a></span><span>
</span><span id="line-107"></span><span>        </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238488"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679238510"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238514"><span class="hs-identifier hs-var">st''</span></a></span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="annottext">State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679238480"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238486"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679238486"><span class="hs-identifier hs-type">st</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238499"><span class="hs-identifier hs-var">good'</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679238509"><span class="hs-identifier hs-var">bad'</span></a></span><span>
</span><span id="line-109"></span><span>
</span><span id="line-110"></span><span class="hs-comment">---------------------------------------------</span><span>
</span><span id="line-111"></span><span class="hs-comment">---- INTERNALS</span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-114"></span><span class="hs-keyword">data</span><span> </span><span id="Direction"><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-var">Direction</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Enter"><span class="annot"><a href="Text.Gigaparsec.Debug.html#Enter"><span class="hs-identifier hs-var">Enter</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Exit"><span class="annot"><a href="Text.Gigaparsec.Debug.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span></span><span>
</span><span id="line-115"></span><span>
</span><span id="line-116"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#breakOnEntry"><span class="hs-identifier hs-type">breakOnEntry</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier hs-type">Break</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-117"></span><span id="breakOnEntry"><span class="annot"><span class="annottext">breakOnEntry :: Break -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#breakOnEntry"><span class="hs-identifier hs-var hs-var">breakOnEntry</span></a></span></span><span> </span><span class="annot"><span class="annottext">Break
</span><a href="Text.Gigaparsec.Debug.html#OnEntry"><span class="hs-identifier hs-var">OnEntry</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-118"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#breakOnEntry"><span class="hs-identifier hs-var">breakOnEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Break
</span><a href="Text.Gigaparsec.Debug.html#Always"><span class="hs-identifier hs-var">Always</span></a></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-119"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#breakOnEntry"><span class="hs-identifier hs-var">breakOnEntry</span></a></span><span> </span><span class="annot"><span class="annottext">Break
</span><span class="hs-identifier">_</span></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-120"></span><span>
</span><span id="line-121"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#breakOnExit"><span class="hs-identifier hs-type">breakOnExit</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier hs-type">Break</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-122"></span><span id="breakOnExit"><span class="annot"><span class="annottext">breakOnExit :: Break -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#breakOnExit"><span class="hs-identifier hs-var hs-var">breakOnExit</span></a></span></span><span> </span><span class="annot"><span class="annottext">Break
</span><a href="Text.Gigaparsec.Debug.html#OnExit"><span class="hs-identifier hs-var">OnExit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#breakOnExit"><span class="hs-identifier hs-var">breakOnExit</span></a></span><span> </span><span class="annot"><span class="annottext">Break
</span><a href="Text.Gigaparsec.Debug.html#Always"><span class="hs-identifier hs-var">Always</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-124"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#breakOnExit"><span class="hs-identifier hs-var">breakOnExit</span></a></span><span> </span><span class="annot"><span class="annottext">Break
</span><span class="hs-identifier">_</span></span><span>      </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#shouldBreak"><span class="hs-identifier hs-type">shouldBreak</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Break"><span class="hs-identifier hs-type">Break</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span>
</span><span id="line-127"></span><span id="shouldBreak"><span class="annot"><span class="annottext">shouldBreak :: Direction -&gt; Break -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#shouldBreak"><span class="hs-identifier hs-var hs-var">shouldBreak</span></a></span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Enter"><span class="hs-identifier hs-var">Enter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Break -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#breakOnEntry"><span class="hs-identifier hs-var">breakOnEntry</span></a></span><span>
</span><span id="line-128"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#shouldBreak"><span class="hs-identifier hs-var">shouldBreak</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Break -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#breakOnExit"><span class="hs-identifier hs-var">breakOnExit</span></a></span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#doDebug"><span class="hs-identifier hs-type">doDebug</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#State"><span class="hs-identifier hs-type">Internal.State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html#RT"><span class="hs-identifier hs-type">Internal.RT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span id="doDebug"><span class="annot"><span class="annottext">doDebug :: String -&gt; Direction -&gt; State -&gt; String -&gt; DebugConfig -&gt; RT ()
</span><a href="Text.Gigaparsec.Debug.html#doDebug"><span class="hs-identifier hs-var hs-var">doDebug</span></a></span></span><span> </span><span id="local-6989586621679238520"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238520"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679238521"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238521"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679238522"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238522"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679238523"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238523"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#DebugConfig"><span class="hs-identifier hs-type">DebugConfig</span></a></span><span class="hs-special">{</span><span id="local-6989586621679238524"><span id="local-6989586621679238525"><span id="local-6989586621679238526"><span id="local-6989586621679238527"><span class="annot"><span class="annottext">Bool
[WatchedReg]
Handle
Break
ascii :: DebugConfig -&gt; Bool
breakPoint :: DebugConfig -&gt; Break
watchedRegs :: DebugConfig -&gt; [WatchedReg]
handle :: DebugConfig -&gt; Handle
ascii :: Bool
breakPoint :: Break
watchedRegs :: [WatchedReg]
handle :: Handle
</span><a href="Text.Gigaparsec.Debug.html#ascii"><span class="hs-glyph hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">..</span></a></span></span></span></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-132"></span><span>  </span><span class="annot"><span class="annottext">Handle
-&gt; String
-&gt; Direction
-&gt; State
-&gt; String
-&gt; Bool
-&gt; [WatchedReg]
-&gt; RT ()
</span><a href="Text.Gigaparsec.Debug.html#printInfo"><span class="hs-identifier hs-var">printInfo</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679238527"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238520"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238521"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238522"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238523"><span class="hs-identifier hs-var">end</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238524"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">[WatchedReg]
</span><a href="#local-6989586621679238526"><span class="hs-identifier hs-var">watchedRegs</span></a></span><span>
</span><span id="line-133"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; RT () -&gt; RT ()
forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><span class="hs-identifier hs-var">when</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Direction -&gt; Break -&gt; Bool
</span><a href="Text.Gigaparsec.Debug.html#shouldBreak"><span class="hs-identifier hs-var">shouldBreak</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238521"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">Break
</span><a href="#local-6989586621679238525"><span class="hs-identifier hs-var">breakPoint</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">RT ()
</span><a href="Text.Gigaparsec.Debug.html#waitForUser"><span class="hs-identifier hs-var">waitForUser</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#printInfo"><span class="hs-identifier hs-type">printInfo</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Handle</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#State"><span class="hs-identifier hs-type">Internal.State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier hs-type">WatchedReg</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html#RT"><span class="hs-identifier hs-type">Internal.RT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-136"></span><span id="printInfo"><span class="annot"><span class="annottext">printInfo :: Handle
-&gt; String
-&gt; Direction
-&gt; State
-&gt; String
-&gt; Bool
-&gt; [WatchedReg]
-&gt; RT ()
</span><a href="Text.Gigaparsec.Debug.html#printInfo"><span class="hs-identifier hs-var hs-var">printInfo</span></a></span></span><span> </span><span id="local-6989586621679238530"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679238530"><span class="hs-identifier hs-var">handle</span></a></span></span><span> </span><span id="local-6989586621679238531"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238531"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679238532"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238532"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679238533"><span class="annot"><span class="annottext">st :: State
</span><a href="#local-6989586621679238533"><span class="hs-identifier hs-var">st</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#State"><span class="hs-identifier hs-type">Internal.State</span></a></span><span class="hs-special">{</span><span id="local-6989586621679238535"><span class="annot"><span class="annottext">String
input :: String
input :: State -&gt; String
</span><a href="#local-6989586621679238535"><span class="hs-identifier hs-var hs-var">input</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238537"><span class="annot"><span class="annottext">Word
line :: Word
line :: State -&gt; Word
</span><a href="#local-6989586621679238537"><span class="hs-identifier hs-var hs-var">line</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679238539"><span class="annot"><span class="annottext">Word
col :: Word
col :: State -&gt; Word
</span><a href="#local-6989586621679238539"><span class="hs-identifier hs-var hs-var">col</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679238541"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238541"><span class="hs-identifier hs-var">end</span></a></span></span><span> </span><span id="local-6989586621679238542"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span></span><span> </span><span id="local-6989586621679238543"><span class="annot"><span class="annottext">[WatchedReg]
</span><a href="#local-6989586621679238543"><span class="hs-identifier hs-var">regs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238547"><span class="annot"><span class="annottext">cs :: String
</span><a href="#local-6989586621679238547"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\n&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#newline"><span class="hs-identifier hs-var">newline</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>         </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#space"><span class="hs-identifier hs-var">space</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>         </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\r&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#carriageReturn"><span class="hs-identifier hs-var">carriageReturn</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>         </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; (String -&gt; String) -&gt; String -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#replace"><span class="hs-identifier hs-var">replace</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;\t&quot;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#tab"><span class="hs-identifier hs-var">tab</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-141"></span><span>         </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; String -&gt; String
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">take</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238535"><span class="hs-identifier hs-var">input</span></a></span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238561"><span class="annot"><span class="annottext">cs' :: String
</span><a href="#local-6989586621679238561"><span class="hs-identifier hs-var hs-var">cs'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238547"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">5</span></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238547"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#endOfInput"><span class="hs-identifier hs-var">endOfInput</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238547"><span class="hs-identifier hs-var">cs</span></a></span><span>
</span><span id="line-143"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238570"><span class="annot"><span class="annottext">prelude :: String
</span><a href="#local-6989586621679238570"><span class="hs-identifier hs-var hs-var">prelude</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#portal"><span class="hs-identifier hs-var">portal</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238532"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238531"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">(Word, Word) -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679238537"><span class="hs-identifier hs-var">line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679238539"><span class="hs-identifier hs-var">col</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;: &quot;</span></span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679238574"><span class="annot"><span class="annottext">caret :: String
</span><a href="#local-6989586621679238574"><span class="hs-identifier hs-var hs-var">caret</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238570"><span class="hs-identifier hs-var">prelude</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#blue"><span class="hs-identifier hs-var">blue</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238542"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;^&quot;</span></span><span>
</span><span id="line-145"></span><span>  </span><span id="local-6989586621679238577"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679238577"><span class="hs-identifier hs-var">regSummary</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-146"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">[WatchedReg] -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">[WatchedReg]
</span><a href="#local-6989586621679238543"><span class="hs-identifier hs-var">regs</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; RT [String]
forall a. a -&gt; RT a
forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><span class="hs-identifier hs-var">return</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[String] -&gt; [String] -&gt; [String]
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String])
-&gt; ([String] -&gt; [String]) -&gt; [String] -&gt; [String]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;watched registers:&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([String] -&gt; [String]) -&gt; RT [String] -&gt; RT [String]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span>
</span><span id="line-148"></span><span>      </span><span class="annot"><span class="annottext">[WatchedReg] -&gt; (WatchedReg -&gt; RT String) -&gt; RT [String]
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><span class="hs-identifier hs-var">forM</span></span><span> </span><span class="annot"><span class="annottext">[WatchedReg]
</span><a href="#local-6989586621679238543"><span class="hs-identifier hs-var">regs</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Debug.html#WatchedReg"><span class="hs-identifier hs-type">WatchedReg</span></a></span><span> </span><span id="local-6989586621679238582"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238582"><span class="hs-identifier hs-var">rname</span></a></span></span><span> </span><span id="local-6989586621679238583"><span class="annot"><span class="annottext">Reg r a
</span><a href="#local-6989586621679238583"><span class="hs-identifier hs-var">reg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679238584"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679238584"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;    &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238582"><span class="hs-identifier hs-var">rname</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot; = &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679238584"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; String) -&gt; RT a -&gt; RT String
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Reg r a -&gt; RT a
forall r a. Reg r a -&gt; RT a
</span><a href="Text.Gigaparsec.Internal.RT.html#readReg"><span class="hs-identifier hs-var">readReg</span></a></span><span> </span><span class="annot"><span class="annottext">Reg r a
</span><a href="#local-6989586621679238583"><span class="hs-identifier hs-var">reg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="annottext">IO () -&gt; RT ()
forall a. IO a -&gt; RT a
</span><a href="Text.Gigaparsec.Internal.RT.html#unsafeIOToRT"><span class="hs-identifier hs-var">Internal.unsafeIOToRT</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; RT ()) -&gt; IO () -&gt; RT ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><span class="annottext">Handle -&gt; String -&gt; IO ()
</span><span class="hs-identifier hs-var">hPutStr</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679238530"><span class="hs-identifier hs-var">handle</span></a></span><span> </span><span class="annot"><span class="annottext">(String -&gt; IO ()) -&gt; String -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">State -&gt; [String] -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#indentAndUnlines"><span class="hs-identifier hs-var">indentAndUnlines</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238533"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238570"><span class="hs-identifier hs-var">prelude</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238561"><span class="hs-identifier hs-var">cs'</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238541"><span class="hs-identifier hs-var">end</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238574"><span class="hs-identifier hs-var">caret</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; [String]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679238577"><span class="hs-identifier hs-var">regSummary</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#waitForUser"><span class="hs-identifier hs-type">waitForUser</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.RT.html#RT"><span class="hs-identifier hs-type">Internal.RT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-154"></span><span id="waitForUser"><span class="annot"><span class="annottext">waitForUser :: RT ()
</span><a href="Text.Gigaparsec.Debug.html#waitForUser"><span class="hs-identifier hs-var hs-var">waitForUser</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; RT ()
forall a. IO a -&gt; RT a
</span><a href="Text.Gigaparsec.Internal.RT.html#unsafeIOToRT"><span class="hs-identifier hs-var">Internal.unsafeIOToRT</span></a></span><span> </span><span class="annot"><span class="annottext">(IO () -&gt; RT ()) -&gt; IO () -&gt; RT ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679238586"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238586"><span class="hs-identifier hs-var">echo</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Handle -&gt; IO Bool
</span><span class="hs-identifier hs-var">hGetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span>
</span><span id="line-156"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-157"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; IO ()
</span><span class="hs-identifier hs-var">putStrLn</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;...&quot;</span></span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="annottext">Char
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO Char
</span><span class="hs-identifier hs-var">getChar</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="annot"><span class="annottext">Handle -&gt; Bool -&gt; IO ()
</span><span class="hs-identifier hs-var">hSetEcho</span></span><span> </span><span class="annot"><span class="annottext">Handle
</span><span class="hs-identifier hs-var">stdin</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238586"><span class="hs-identifier hs-var">echo</span></a></span><span>
</span><span id="line-160"></span><span>
</span><span id="line-161"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#render"><span class="hs-identifier hs-type">render</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-162"></span><span id="render"><span class="annot"><span class="annottext">render :: Direction -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#render"><span class="hs-identifier hs-var hs-var">render</span></a></span></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Enter"><span class="hs-identifier hs-var">Enter</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&gt;&quot;</span></span><span>
</span><span id="line-163"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="Text.Gigaparsec.Debug.html#Exit"><span class="hs-identifier hs-var">Exit</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&lt;&quot;</span></span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#portal"><span class="hs-identifier hs-type">portal</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#Direction"><span class="hs-identifier hs-type">Direction</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-166"></span><span id="portal"><span class="annot"><span class="annottext">portal :: Direction -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#portal"><span class="hs-identifier hs-var hs-var">portal</span></a></span></span><span> </span><span id="local-6989586621679238590"><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238590"><span class="hs-identifier hs-var">dir</span></a></span></span><span> </span><span id="local-6989586621679238591"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238591"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Direction -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238590"><span class="hs-identifier hs-var">dir</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238591"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">Direction -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#render"><span class="hs-identifier hs-var">render</span></a></span><span> </span><span class="annot"><span class="annottext">Direction
</span><a href="#local-6989586621679238590"><span class="hs-identifier hs-var">dir</span></a></span><span>
</span><span id="line-167"></span><span>
</span><span id="line-168"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#indent"><span class="hs-identifier hs-type">indent</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#State"><span class="hs-identifier hs-type">Internal.State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-169"></span><span id="indent"><span class="annot"><span class="annottext">indent :: State -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#indent"><span class="hs-identifier hs-var hs-var">indent</span></a></span></span><span> </span><span id="local-6989586621679238593"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238593"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Char -&gt; String
forall a. Int -&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">replicate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Int
</span><a href="Text.Gigaparsec.Internal.html#debugLevel"><span class="hs-identifier hs-var">Internal.debugLevel</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238593"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Int
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">*</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#indentAndUnlines"><span class="hs-identifier hs-type">indentAndUnlines</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#State"><span class="hs-identifier hs-type">Internal.State</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-172"></span><span id="indentAndUnlines"><span class="annot"><span class="annottext">indentAndUnlines :: State -&gt; [String] -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#indentAndUnlines"><span class="hs-identifier hs-var hs-var">indentAndUnlines</span></a></span></span><span> </span><span id="local-6989586621679238595"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238595"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[String] -&gt; String
</span><span class="hs-identifier hs-var">unlines</span></span><span> </span><span class="annot"><span class="annottext">([String] -&gt; String)
-&gt; ([String] -&gt; [String]) -&gt; [String] -&gt; String
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(String -&gt; String) -&gt; [String] -&gt; [String]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#indent"><span class="hs-identifier hs-var">indent</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679238595"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; String
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span class="hs-special">)</span><span>
</span><span id="line-173"></span><span>
</span><span id="line-174"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#green"><span class="hs-identifier hs-type">green</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#red"><span class="hs-identifier hs-type">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#white"><span class="hs-identifier hs-type">white</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#blue"><span class="hs-identifier hs-type">blue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-175"></span><span id="green"><span class="annot"><span class="annottext">green :: Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#green"><span class="hs-identifier hs-var hs-var">green</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-var">colour</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">Green</span></span><span>
</span><span id="line-176"></span><span id="red"><span class="annot"><span class="annottext">red :: Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#red"><span class="hs-identifier hs-var hs-var">red</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-var">colour</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">Red</span></span><span>
</span><span id="line-177"></span><span id="white"><span class="annot"><span class="annottext">white :: Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#white"><span class="hs-identifier hs-var hs-var">white</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-var">colour</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">White</span></span><span>
</span><span id="line-178"></span><span id="blue"><span class="annot"><span class="annottext">blue :: Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#blue"><span class="hs-identifier hs-var hs-var">blue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Color -&gt; Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-var">colour</span></a></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier hs-var">Blue</span></span><span>
</span><span id="line-179"></span><span>
</span><span id="line-180"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-type">colour</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Color</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-181"></span><span id="colour"><span class="annot"><span class="annottext">colour :: Color -&gt; Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-var hs-var">colour</span></a></span></span><span> </span><span class="annot"><span class="annottext">Color
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span> </span><span id="local-6989586621679238599"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238599"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238599"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-182"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#colour"><span class="hs-identifier hs-var">colour</span></a></span><span> </span><span id="local-6989586621679238600"><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679238600"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span> </span><span id="local-6989586621679238601"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238601"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Color -&gt; String -&gt; String
forall a. Pretty a =&gt; Color -&gt; a -&gt; a
</span><span class="hs-identifier hs-var">color</span></span><span> </span><span class="annot"><span class="annottext">Color
</span><a href="#local-6989586621679238600"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238601"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#newline"><span class="hs-identifier hs-type">newline</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#space"><span class="hs-identifier hs-type">space</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#carriageReturn"><span class="hs-identifier hs-type">carriageReturn</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#tab"><span class="hs-identifier hs-type">tab</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Debug.html#endOfInput"><span class="hs-identifier hs-type">endOfInput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-185"></span><span id="newline"><span class="annot"><span class="annottext">newline :: Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#newline"><span class="hs-identifier hs-var hs-var">newline</span></a></span></span><span> </span><span id="local-6989586621679238602"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238602"><span class="hs-identifier hs-var">ascii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#green"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238602"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8601;&quot;</span></span><span>
</span><span id="line-186"></span><span id="space"><span class="annot"><span class="annottext">space :: Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#space"><span class="hs-identifier hs-var hs-var">space</span></a></span></span><span> </span><span id="local-6989586621679238603"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238603"><span class="hs-identifier hs-var">ascii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#white"><span class="hs-identifier hs-var">white</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238603"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#183;&quot;</span></span><span>
</span><span id="line-187"></span><span id="carriageReturn"><span class="annot"><span class="annottext">carriageReturn :: Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#carriageReturn"><span class="hs-identifier hs-var hs-var">carriageReturn</span></a></span></span><span> </span><span id="local-6989586621679238604"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238604"><span class="hs-identifier hs-var">ascii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#green"><span class="hs-identifier hs-var">green</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238604"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8592;&quot;</span></span><span>
</span><span id="line-188"></span><span id="tab"><span class="annot"><span class="annottext">tab :: Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#tab"><span class="hs-identifier hs-var hs-var">tab</span></a></span></span><span> </span><span id="local-6989586621679238605"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238605"><span class="hs-identifier hs-var">ascii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#white"><span class="hs-identifier hs-var">white</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238605"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8594;&quot;</span></span><span>
</span><span id="line-189"></span><span id="endOfInput"><span class="annot"><span class="annottext">endOfInput :: Bool -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#endOfInput"><span class="hs-identifier hs-var hs-var">endOfInput</span></a></span></span><span> </span><span id="local-6989586621679238606"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238606"><span class="hs-identifier hs-var">ascii</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#red"><span class="hs-identifier hs-var">red</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679238606"><span class="hs-identifier hs-var">ascii</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&#8226;&quot;</span></span><span>
</span><span id="line-190"></span><span>
</span><span id="line-191"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#replace"><span class="hs-identifier hs-type">replace</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-192"></span><span id="replace"><span class="annot"><span class="annottext">replace :: String -&gt; String -&gt; String -&gt; String
</span><a href="Text.Gigaparsec.Debug.html#replace"><span class="hs-identifier hs-var hs-var">replace</span></a></span></span><span> </span><span id="local-6989586621679238607"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238607"><span class="hs-identifier hs-var">needle</span></a></span></span><span> </span><span id="local-6989586621679238608"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238608"><span class="hs-identifier hs-var">replacement</span></a></span></span><span> </span><span id="local-6989586621679238609"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238609"><span class="hs-identifier hs-var">haystack</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>  </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; String
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><span class="hs-identifier hs-var">intercalate</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238608"><span class="hs-identifier hs-var">replacement</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty String -&gt; [String]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String -&gt; String -&gt; NonEmpty String
</span><a href="Text.Gigaparsec.Debug.html#splitOn"><span class="hs-identifier hs-var">splitOn</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238607"><span class="hs-identifier hs-var">needle</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238609"><span class="hs-identifier hs-var">haystack</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="annot"><a href="Text.Gigaparsec.Debug.html#splitOn"><span class="hs-identifier hs-type">splitOn</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>
</span><span id="line-196"></span><span id="splitOn"><span class="annot"><span class="annottext">splitOn :: String -&gt; String -&gt; NonEmpty String
</span><a href="Text.Gigaparsec.Debug.html#splitOn"><span class="hs-identifier hs-var hs-var">splitOn</span></a></span></span><span> </span><span id="local-6989586621679238611"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238611"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; NonEmpty String
</span><a href="#local-6989586621679238612"><span class="hs-identifier hs-var">go</span></a></span><span>
</span><span id="line-197"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679238612"><span class="annot"><span class="annottext">go :: String -&gt; NonEmpty String
</span><a href="#local-6989586621679238612"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621679238615"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238615"><span class="hs-identifier hs-var">src</span></a></span></span><span>
</span><span id="line-198"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">String -&gt; String -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><span class="hs-identifier hs-var">isPrefixOf</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238611"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238615"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NonEmpty String -&gt; NonEmpty String
forall a. a -&gt; NonEmpty a -&gt; NonEmpty a
</span><span class="hs-operator hs-var">&lt;|</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; NonEmpty String
</span><a href="#local-6989586621679238612"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; String -&gt; String
forall a. Int -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">drop</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679238617"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238615"><span class="hs-identifier hs-var">src</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-199"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span id="local-6989586621679238618"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679238618"><span class="hs-identifier hs-var">c</span></a></span></span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span id="local-6989586621679238619"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238619"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238615"><span class="hs-identifier hs-var">src</span></a></span><span>        </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679238620"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238620"><span class="hs-identifier hs-var">w</span></a></span></span><span> </span><span class="annot"><span class="hs-operator hs-type">:|</span></span><span> </span><span id="local-6989586621679238621"><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679238621"><span class="hs-identifier hs-var">ws</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; NonEmpty String
</span><a href="#local-6989586621679238612"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238619"><span class="hs-identifier hs-var">cs</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679238618"><span class="hs-identifier hs-var">c</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; String -&gt; String
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238620"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; NonEmpty String
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="annot"><span class="annottext">[String]
</span><a href="#local-6989586621679238621"><span class="hs-identifier hs-var">ws</span></a></span><span>
</span><span id="line-200"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; [String] -&gt; NonEmpty String
forall a. a -&gt; [a] -&gt; NonEmpty a
</span><span class="hs-operator hs-var">:|</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679238617"><span class="annot"><span class="annottext">n :: Int
</span><a href="#local-6989586621679238617"><span class="hs-identifier hs-var hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String -&gt; Int
forall a. [a] -&gt; Int
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><span class="hs-identifier hs-var">length</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679238611"><span class="hs-identifier hs-var">pat</span></a></span><span>
</span><span id="line-202"></span></pre></body></html>