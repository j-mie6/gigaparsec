<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-missing-import-lists #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# OPTIONS_GHC -Wno-incomplete-record-updates #-}</span><span>
</span><span id="line-4"></span><span class="annot"><span class="hs-comment">{-|
Module      : Text.Gigaparsec.Errors.Combinator
Description : This module contains combinators that can be used to directly influence error
              messages of parsers.
License     : BSD-3-Clause
Maintainer  : Jamie Willis, Gigaparsec Maintainers
Stability   : stable

Error messages are, by default, not /particularly/ descriptive. However, the combinators in this
module can be used to improve the generation of error messages by providing labels for expected
items, explanations for why things went wrong, custom error messages, custom unexpected error messages,
as well as correcting the offsets that error messages actually occurred at.

==== Terminology

__Observably consumes input__: a parser is said to /observably/ consume input when error messages generated by a parser @p@ occur at a deeper
offset than @p@ originally started at. While this sounds like it is the same as &quot;having consumed input&quot; for the
purposes of backtracking, they are disjoint concepts:

  1. in @atomic p@, @p@ can /observably/ consume input even though the wider parser does not consume input due to the @atomic@.
  2. in @amend p@, @p@ can consume input and may not backtrack even though the consumption is not /observable/ in the error
     message due to the @amend@.

@since 0.2.0.0
-}</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html"><span class="hs-identifier">Text.Gigaparsec.Errors.Combinator</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Error Enrichment Combinators</span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-comment">-- | These combinators add additional information - or refine the existing information within - to</span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-comment">-- an error message that has been generated within the scope of the parser they have been called on.</span><span>
</span><span id="line-33"></span><span>  </span><span class="hs-comment">-- These are a very basic, but effective, way of improving the quality of error messages generated</span><span>
</span><span id="line-34"></span><span>  </span><span class="hs-comment">-- by gigaparsec.</span><span>
</span><span id="line-35"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#label"><span class="hs-keyword">label</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#%3C%3F%3E"><span class="hs-operator">(&lt;?&gt;)</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#hide"><span class="hs-identifier">hide</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#explain"><span class="hs-identifier">explain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Failure Combinators</span></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- | These combinators immediately fail the parser, with a more bespoke message.</span></span><span>
</span><span id="line-38"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#emptyWide"><span class="hs-identifier">emptyWide</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-39"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#fail"><span class="hs-identifier">fail</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#failWide"><span class="hs-identifier">failWide</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-40"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpected"><span class="hs-identifier">unexpected</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWide"><span class="hs-identifier">unexpectedWide</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Error Adjustment Combinators</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="hs-comment">-- | These combinators can affect at what position an error is caused at. They are</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-comment">-- opposites: where 'amend' will ensure an error message is said to have generated</span><span>
</span><span id="line-44"></span><span>  </span><span class="hs-comment">-- at the position on entry to the combinator, 'entrench' will resist these changes.</span><span>
</span><span id="line-45"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#amend"><span class="hs-identifier">amend</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmend"><span class="hs-identifier">partialAmend</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#entrench"><span class="hs-identifier">entrench</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#dislodge"><span class="hs-identifier">dislodge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#dislodgeBy"><span class="hs-identifier">dislodgeBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodge"><span class="hs-identifier">amendThenDislodge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodgeBy"><span class="hs-identifier">amendThenDislodgeBy</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmendThenDislodge"><span class="hs-identifier">partialAmendThenDislodge</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmendThenDislodgeBy"><span class="hs-identifier">partialAmendThenDislodgeBy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#markAsToken"><span class="hs-identifier">markAsToken</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier">filterSWith</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#mapMaybeSWith"><span class="hs-identifier">mapMaybeSWith</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#filterOut"><span class="hs-identifier">filterOut</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#guardAgainst"><span class="hs-identifier">guardAgainst</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWhen"><span class="hs-identifier">unexpectedWhen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWithReasonWhen"><span class="hs-identifier">unexpectedWithReasonWhen</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-50"></span><span>    </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#mapEitherS"><span class="hs-identifier">mapEitherS</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>
</span><span id="line-53"></span><span class="hs-comment">{-
Future doc headings:

Filtering Combinators
=====================
These combinators perform filtering on a parser, with particular emphasis on generating meaningful
error messages if the filtering fails. This is particularly useful for data validation within the
parser, as very instructive error messages describing what went wrong can be generated. These combinators
often filter using a `PartialFunction`: this may be because they combine filtering with mapping (in which
case, the error message is provided separately), or the function may produce a `String`.

In these cases, the partial function is producing the error messages: if the input to the function is
defined, this means that it is invalid and the filtering will fail using the message obtained from the
successful partial function invocation.

Generic Filtering Combinators
=============================
This combinators generalise the combinators from above, which are all special cases of them. Each of these
takes the characteristic predicate or function of the regular variants, but takes an `errGen` object that
can be used to fine-tune the error messages. These offer some flexiblity not offered by the specialised
filtering combinators, but are a little more verbose to use.
-}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prelude</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fail</span></span><span class="hs-special">)</span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html"><span class="hs-identifier">Text.Gigaparsec.Errors.ErrorGen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#ErrorGen"><span class="hs-identifier">ErrorGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#vanillaGen"><span class="hs-identifier">vanillaGen</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#specializedGen"><span class="hs-identifier">specializedGen</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-79"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html"><span class="hs-identifier">Text.Gigaparsec.Errors.ErrorGen</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">ErrorGen</span></span><span>
</span><span id="line-80"></span><span class="hs-comment">-- We want to use this to make the docs point to the right definition for users.</span><span>
</span><span id="line-81"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html"><span class="hs-identifier">Text.Gigaparsec.Internal</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier">Parsec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html"><span class="hs-identifier">Text.Gigaparsec.Internal</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier">Parsec</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier">Parsec</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#line"><span class="hs-identifier">line</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#col"><span class="hs-identifier">col</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#emptyErr"><span class="hs-identifier">emptyErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#specialisedErr"><span class="hs-identifier">specialisedErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#raise"><span class="hs-identifier">raise</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#unexpectedErr"><span class="hs-identifier">unexpectedErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier">hints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier">consumed</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#useHints"><span class="hs-identifier">useHints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#adjustErr"><span class="hs-identifier">adjustErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier">hints</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hintsValidOffset"><span class="hs-identifier">hintsValidOffset</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html"><span class="hs-identifier">Text.Gigaparsec.Internal.Errors</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#Error"><span class="hs-identifier">Error</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#CaretWidth"><span class="hs-identifier">CaretWidth</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#FlexibleCaret"><span class="hs-identifier">FlexibleCaret</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#RigidCaret"><span class="hs-identifier">RigidCaret</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-84"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html"><span class="hs-identifier">Text.Gigaparsec.Internal.Errors</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Internal</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#setLexical"><span class="hs-identifier">setLexical</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#amendErr"><span class="hs-identifier">amendErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#entrenchErr"><span class="hs-identifier">entrenchErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#dislodgeErr"><span class="hs-identifier">dislodgeErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#partialAmendErr"><span class="hs-identifier">partialAmendErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#labelErr"><span class="hs-identifier">labelErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#explainErr"><span class="hs-identifier">explainErr</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#replaceHints"><span class="hs-identifier">replaceHints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Require.html"><span class="hs-identifier">Text.Gigaparsec.Internal.Require</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.Require.html#require"><span class="hs-identifier">require</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Position.html"><span class="hs-identifier">Text.Gigaparsec.Position</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Position.html#withWidth"><span class="hs-identifier">withWidth</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">empty</span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">toList</span></span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">isNothing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">fromJust</span></span><span class="hs-special">)</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="annot"><span class="hs-comment">{-|
This combinator changes the expected component of any errors generated by this parser.

When this parser fails having not /observably/ consumed input, the expected component of the generated
error message is set to be the given items.
-}</span></span><span>
</span><span id="line-100"></span><span id="local-6989586621679243972"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#label"><span class="hs-keyword hs-type">label</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the names to give to the expected component of any qualifying errors.</span></span><span>
</span><span id="line-101"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243972"><span class="hs-identifier hs-type">a</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the parser to apply the labels to</span></span><span>
</span><span id="line-102"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243972"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-103"></span><span id="label"><span class="annot"><span class="annottext">label :: forall a. Set String -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#label"><span class="hs-keyword hs-var hs-var">label</span></a></span></span><span> </span><span id="local-6989586621679244147"><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679244147"><span class="hs-identifier hs-var">ls</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Internal.Parsec</span></a></span><span> </span><span id="local-6989586621679244148"><span class="annot"><span class="annottext">forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244148"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; String -&gt; String -&gt; Parsec a -&gt; Parsec a
forall a. Bool -&gt; String -&gt; String -&gt; a -&gt; a
</span><a href="Text.Gigaparsec.Internal.Require.html#require"><span class="hs-identifier hs-var">require</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Set String -&gt; Bool
forall a. Set a -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679244147"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><span class="hs-operator hs-var">&amp;&amp;</span></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><span class="hs-identifier hs-var">not</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(String -&gt; Bool) -&gt; Set String -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; (a -&gt; Bool) -&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">any</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Bool
</span><span class="hs-identifier hs-var">null</span></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679244147"><span class="hs-identifier hs-var">ls</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Text.Gigaparsec.Errors.Combinator.label&quot;</span></span><span>
</span><span id="line-105"></span><span>                                               </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;labels cannot be empty&quot;</span></span><span> </span><span class="annot"><span class="annottext">(Parsec a -&gt; Parsec a) -&gt; Parsec a -&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-106"></span><span>    </span><span class="annot"><span class="annottext">(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a.
(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-var">Internal.Parsec</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
 -&gt; Parsec a)
-&gt; (forall r.
    State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244153"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244153"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679244154"><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244154"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span id="local-6989586621679244155"><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244155"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-107"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679244156"><span class="annot"><span class="annottext">origConsumed :: Word
</span><a href="#local-6989586621679244156"><span class="hs-identifier hs-var hs-var">origConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244153"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-108"></span><span>          </span><span id="local-6989586621679244159"><span class="annot"><span class="annottext">good' :: a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244159"><span class="hs-identifier hs-var hs-var">good'</span></a></span></span><span> </span><span id="local-6989586621679244160"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244160"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679244161"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244161"><span class="hs-identifier hs-var">st'</span></a></span></span><span>
</span><span id="line-109"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244161"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244156"><span class="hs-identifier hs-var">origConsumed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244154"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244161"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244154"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244160"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244161"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier hs-var">Internal.hints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#replaceHints"><span class="hs-identifier hs-type">Internal.replaceHints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244147"><span class="hs-identifier hs-type">ls</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier hs-var">Internal.hints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244161"><span class="hs-identifier hs-type">st'</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-111"></span><span>          </span><span id="local-6989586621679244163"><span class="annot"><span class="annottext">bad' :: Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244163"><span class="hs-identifier hs-var hs-var">bad'</span></a></span></span><span> </span><span id="local-6989586621679244164"><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244164"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; State -&gt; RT r) -&gt; Error -&gt; State -&gt; RT r
forall r. (Error -&gt; State -&gt; RT r) -&gt; Error -&gt; State -&gt; RT r
</span><a href="Text.Gigaparsec.Internal.html#useHints"><span class="hs-identifier hs-var">Internal.useHints</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244155"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Set String -&gt; Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#labelErr"><span class="hs-identifier hs-var">Internal.labelErr</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244156"><span class="hs-identifier hs-var">origConsumed</span></a></span><span> </span><span class="annot"><span class="annottext">Set String
</span><a href="#local-6989586621679244147"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244164"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-112"></span><span>      </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244148"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244153"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244159"><span class="hs-identifier hs-var">good'</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244163"><span class="hs-identifier hs-var">bad'</span></a></span><span>
</span><span id="line-113"></span><span>
</span><span id="line-114"></span><span class="annot"><span class="hs-comment">{-|
This combinator suppresses the entire error message generated by a given parser.

When this parser fails having not /observably/ consumed input, this combinator
replaces any error generated by the given parser to match the 'Text.Gigaparsec.empty' combinator.

This can be useful, say, for hiding whitespace labels, which are not normally useful
information to include in an error message for whitespace insensitive grammars.
-}</span></span><span>
</span><span id="line-123"></span><span id="local-6989586621679243993"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#hide"><span class="hs-identifier hs-type">hide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243993"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243993"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-124"></span><span id="hide"><span class="annot"><span class="annottext">hide :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#hide"><span class="hs-identifier hs-var hs-var">hide</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Internal.Parsec</span></a></span><span> </span><span id="local-6989586621679244165"><span class="annot"><span class="annottext">forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244165"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-125"></span><span>  </span><span class="annot"><span class="annottext">(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a.
(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-var">Internal.Parsec</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
 -&gt; Parsec a)
-&gt; (forall r.
    State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244166"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244166"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679244167"><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244167"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span id="local-6989586621679244168"><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244168"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-126"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679244169"><span class="annot"><span class="annottext">origConsumed :: Word
</span><a href="#local-6989586621679244169"><span class="hs-identifier hs-var hs-var">origConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244166"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-127"></span><span>        </span><span id="local-6989586621679244170"><span class="annot"><span class="annottext">good' :: a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244170"><span class="hs-identifier hs-var hs-var">good'</span></a></span></span><span> </span><span id="local-6989586621679244171"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244171"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679244172"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244172"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244167"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244171"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244172"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-special">{</span><span>
</span><span id="line-128"></span><span>          </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier hs-var">Internal.hints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier hs-var">Internal.hints</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244166"><span class="hs-identifier hs-type">st</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-129"></span><span>          </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hintsValidOffset"><span class="hs-identifier hs-var">Internal.hintsValidOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hintsValidOffset"><span class="hs-identifier hs-var">Internal.hintsValidOffset</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244166"><span class="hs-identifier hs-type">st</span></a></span><span>
</span><span id="line-130"></span><span>        </span><span class="hs-special">}</span><span>
</span><span id="line-131"></span><span>        </span><span id="local-6989586621679244174"><span class="annot"><span class="annottext">bad' :: Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244174"><span class="hs-identifier hs-var hs-var">bad'</span></a></span></span><span> </span><span id="local-6989586621679244175"><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244175"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679244176"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244176"><span class="hs-identifier hs-var">st'</span></a></span></span><span>
</span><span id="line-132"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244176"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244169"><span class="hs-identifier hs-var">origConsumed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244168"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244175"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244176"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-133"></span><span>          </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; State -&gt; RT r) -&gt; Error -&gt; State -&gt; RT r
forall r. (Error -&gt; State -&gt; RT r) -&gt; Error -&gt; State -&gt; RT r
</span><a href="Text.Gigaparsec.Internal.html#useHints"><span class="hs-identifier hs-var">Internal.useHints</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244168"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Word -&gt; Error
</span><a href="Text.Gigaparsec.Internal.html#emptyErr"><span class="hs-identifier hs-var">Internal.emptyErr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244176"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244176"><span class="hs-identifier hs-var">st'</span></a></span><span>
</span><span id="line-134"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244165"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244166"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244170"><span class="hs-identifier hs-var">good'</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244174"><span class="hs-identifier hs-var">bad'</span></a></span><span>
</span><span id="line-135"></span><span>
</span><span id="line-136"></span><span class="annot"><span class="hs-comment">{-|
This combinator adds a reason to error messages generated by this parser.

When this parser fails having not /observably/ consumed input, this combinator adds
a reason to the error message, which should justify why the error occured. Unlike error
labels, which may persist if more progress is made having not consumed input, reasons
are not carried forward in the error message, and are lost.
-}</span></span><span>
</span><span id="line-144"></span><span id="local-6989586621679243996"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#explain"><span class="hs-identifier hs-type">explain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ reason the reason why a parser failed.</span></span><span>
</span><span id="line-145"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243996"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the parser to apply the reason to</span></span><span>
</span><span id="line-146"></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243996"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-147"></span><span id="explain"><span class="annot"><span class="annottext">explain :: forall a. String -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#explain"><span class="hs-identifier hs-var hs-var">explain</span></a></span></span><span> </span><span id="local-6989586621679244177"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679244177"><span class="hs-identifier hs-var">reason</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Internal.Parsec</span></a></span><span> </span><span id="local-6989586621679244178"><span class="annot"><span class="annottext">forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244178"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="annottext">(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a.
(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-var">Internal.Parsec</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
 -&gt; Parsec a)
-&gt; (forall r.
    State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244179"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244179"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679244180"><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244180"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span id="local-6989586621679244181"><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244181"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-149"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679244182"><span class="annot"><span class="annottext">origConsumed :: Word
</span><a href="#local-6989586621679244182"><span class="hs-identifier hs-var hs-var">origConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244179"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-150"></span><span>        </span><span id="local-6989586621679244183"><span class="annot"><span class="annottext">bad' :: Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244183"><span class="hs-identifier hs-var hs-var">bad'</span></a></span></span><span> </span><span id="local-6989586621679244184"><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244184"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; State -&gt; RT r) -&gt; Error -&gt; State -&gt; RT r
forall r. (Error -&gt; State -&gt; RT r) -&gt; Error -&gt; State -&gt; RT r
</span><a href="Text.Gigaparsec.Internal.html#useHints"><span class="hs-identifier hs-var">Internal.useHints</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244181"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; String -&gt; Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#explainErr"><span class="hs-identifier hs-var">Internal.explainErr</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244182"><span class="hs-identifier hs-var">origConsumed</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679244177"><span class="hs-identifier hs-var">reason</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244184"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244178"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244179"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244180"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244183"><span class="hs-identifier hs-var">bad'</span></a></span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><span class="hs-comment">{-|
This combinator fails immediately, with a caret of the given width and no other information.

By producing basically no information, this combinator is principally for adjusting the
caret-width of another error, rather than the value 'Text.Gigaparsec.empty', which is used to fail with
no effect on error content.
-}</span></span><span>
</span><span id="line-160"></span><span id="local-6989586621679243999"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#emptyWide"><span class="hs-identifier hs-type">emptyWide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ the width of the caret for the error produced by this combinator.</span></span><span>
</span><span id="line-161"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679243999"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-162"></span><span id="emptyWide"><span class="annot"><span class="annottext">emptyWide :: forall a. Word -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#emptyWide"><span class="hs-identifier hs-var hs-var">emptyWide</span></a></span></span><span> </span><span id="local-6989586621679244185"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244185"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State -&gt; Error) -&gt; Parsec a
forall a. (State -&gt; Error) -&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#raise"><span class="hs-identifier hs-var">Internal.raise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Word -&gt; Error
</span><a href="Text.Gigaparsec.Internal.html#emptyErr"><span class="hs-operator hs-var">`Internal.emptyErr`</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244185"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>
</span><span id="line-164"></span><span class="annot"><span class="hs-comment">{-|
This combinator consumes no input and fails immediately with the given error messages.

Produces a /specialised/ error message where all the lines of the error are the
given @msgs@ in order of appearance.

==== __Examples__
&gt;&gt;&gt; let failing = fail [&quot;hello,&quot;, &quot;this is an error message&quot;, &quot;broken across multiple lines&quot;]

-}</span></span><span>
</span><span id="line-174"></span><span id="local-6989586621679244002"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#fail"><span class="hs-identifier hs-type">fail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the messages that will make up the error message.</span></span><span>
</span><span id="line-175"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244002"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-176"></span><span id="fail"><span class="annot"><span class="annottext">fail :: forall a. NonEmpty String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#fail"><span class="hs-identifier hs-var hs-var">fail</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CaretWidth -&gt; NonEmpty String -&gt; Parsec a
forall a. CaretWidth -&gt; NonEmpty String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_fail"><span class="hs-identifier hs-var">_fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; CaretWidth
</span><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#FlexibleCaret"><span class="hs-identifier hs-var">FlexibleCaret</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-177"></span><span>
</span><span id="line-178"></span><span class="annot"><span class="hs-comment">{-|
This combinator consumes no input and fails immediately with the given error messages.

Produces a /specialised/ error message where all the lines of the error are the
given @msgs@ in order of appearance. The caret width of the message is set to the
given value.

==== __Examples__
&gt;&gt;&gt; let failing = fail 3 [&quot;hello,&quot;, &quot;this is an error message&quot;, &quot;broken across multiple lines&quot;]

-}</span></span><span>
</span><span id="line-189"></span><span id="local-6989586621679244006"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#failWide"><span class="hs-identifier hs-type">failWide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ the width of the caret for the error produced by this combinator.</span></span><span>
</span><span id="line-190"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the messages that will make up the error message.</span></span><span>
</span><span id="line-191"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244006"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-192"></span><span id="failWide"><span class="annot"><span class="annottext">failWide :: forall a. Word -&gt; NonEmpty String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#failWide"><span class="hs-identifier hs-var hs-var">failWide</span></a></span></span><span> </span><span id="local-6989586621679244187"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244187"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CaretWidth -&gt; NonEmpty String -&gt; Parsec a
forall a. CaretWidth -&gt; NonEmpty String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_fail"><span class="hs-identifier hs-var">_fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; CaretWidth
</span><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#RigidCaret"><span class="hs-identifier hs-var">RigidCaret</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244187"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-193"></span><span>
</span><span id="line-194"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#_fail"><span class="hs-pragma hs-type">_fail</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-195"></span><span id="local-6989586621679244005"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#_fail"><span class="hs-identifier hs-type">_fail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#CaretWidth"><span class="hs-identifier hs-type">CaretWidth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244005"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-196"></span><span id="_fail"><span class="annot"><span class="annottext">_fail :: forall a. CaretWidth -&gt; NonEmpty String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_fail"><span class="hs-identifier hs-var hs-var">_fail</span></a></span></span><span> </span><span id="local-6989586621679244188"><span class="annot"><span class="annottext">CaretWidth
</span><a href="#local-6989586621679244188"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621679244189"><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679244189"><span class="hs-identifier hs-var">msgs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State -&gt; Error) -&gt; Parsec a
forall a. (State -&gt; Error) -&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#raise"><span class="hs-identifier hs-var">Internal.raise</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679244190"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244190"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; [String] -&gt; CaretWidth -&gt; Error
</span><a href="Text.Gigaparsec.Internal.html#specialisedErr"><span class="hs-identifier hs-var">Internal.specialisedErr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244190"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NonEmpty String -&gt; [String]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NonEmpty.toList</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty String
</span><a href="#local-6989586621679244189"><span class="hs-identifier hs-var">msgs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">CaretWidth
</span><a href="#local-6989586621679244188"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span class="annot"><span class="hs-comment">{-|
This combinator consumes no input and fails immediately, setting the unexpected component
to the given item.

Produces a /trivial/ error message where the unexpected component of the error is
replaced with the given item.
-}</span></span><span>
</span><span id="line-205"></span><span id="local-6989586621679244010"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpected"><span class="hs-identifier hs-type">unexpected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the unexpected message for the error generated.</span></span><span>
</span><span id="line-206"></span><span>           </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244010"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-207"></span><span id="unexpected"><span class="annot"><span class="annottext">unexpected :: forall a. String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#unexpected"><span class="hs-identifier hs-var hs-var">unexpected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CaretWidth -&gt; String -&gt; Parsec a
forall a. CaretWidth -&gt; String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_unexpected"><span class="hs-identifier hs-var">_unexpected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; CaretWidth
</span><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#FlexibleCaret"><span class="hs-identifier hs-var">FlexibleCaret</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>
</span><span id="line-209"></span><span class="annot"><span class="hs-comment">{-|
This combinator consumes no input and fails immediately, setting the unexpected component
to the given item.

Produces a /trivial/ error message where the unexpected component of the error is
replaced with the given item. The caret width of the message is set to the
given value.
-}</span></span><span>
</span><span id="line-217"></span><span id="local-6989586621679244013"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWide"><span class="hs-identifier hs-type">unexpectedWide</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ the width of the caret for the error produced by this combinator.</span></span><span>
</span><span id="line-218"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the unexpected message for the error generated.</span></span><span>
</span><span id="line-219"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244013"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-220"></span><span id="unexpectedWide"><span class="annot"><span class="annottext">unexpectedWide :: forall a. Word -&gt; String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWide"><span class="hs-identifier hs-var hs-var">unexpectedWide</span></a></span></span><span> </span><span id="local-6989586621679244192"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244192"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">CaretWidth -&gt; String -&gt; Parsec a
forall a. CaretWidth -&gt; String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_unexpected"><span class="hs-identifier hs-var">_unexpected</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; CaretWidth
</span><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#RigidCaret"><span class="hs-identifier hs-var">RigidCaret</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244192"><span class="hs-identifier hs-var">width</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-221"></span><span>
</span><span id="line-222"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#_unexpected"><span class="hs-pragma hs-type">_unexpected</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-223"></span><span id="local-6989586621679244012"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#_unexpected"><span class="hs-identifier hs-type">_unexpected</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.CaretControl.html#CaretWidth"><span class="hs-identifier hs-type">CaretWidth</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244012"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-224"></span><span id="_unexpected"><span class="annot"><span class="annottext">_unexpected :: forall a. CaretWidth -&gt; String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_unexpected"><span class="hs-identifier hs-var hs-var">_unexpected</span></a></span></span><span> </span><span id="local-6989586621679244193"><span class="annot"><span class="annottext">CaretWidth
</span><a href="#local-6989586621679244193"><span class="hs-identifier hs-var">width</span></a></span></span><span> </span><span id="local-6989586621679244194"><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679244194"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(State -&gt; Error) -&gt; Parsec a
forall a. (State -&gt; Error) -&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#raise"><span class="hs-identifier hs-var">Internal.raise</span></a></span><span> </span><span class="annot"><span class="annottext">((State -&gt; Error) -&gt; Parsec a) -&gt; (State -&gt; Error) -&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244195"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244195"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">State -&gt; Set ExpectItem -&gt; String -&gt; CaretWidth -&gt; Error
</span><a href="Text.Gigaparsec.Internal.html#unexpectedErr"><span class="hs-identifier hs-var">Internal.unexpectedErr</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244195"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">Set ExpectItem
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span> </span><span class="annot"><span class="annottext">String
</span><a href="#local-6989586621679244194"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">CaretWidth
</span><a href="#local-6989586621679244193"><span class="hs-identifier hs-var">width</span></a></span><span>
</span><span id="line-225"></span><span>
</span><span id="line-226"></span><span class="annot"><span class="hs-comment">{-|
This combinator adjusts any error messages generated by the given parser so that they
occur at the position recorded on entry to this combinator (effectively as if no
input were consumed).

This is useful if validation work is done
on the output of a parser that may render it invalid, but the error should point to the
beginning of the structure. This combinators effect can be cancelled with 'entrench'.

==== __Examples__
&gt;&gt;&gt; let greeting = string &quot;hello world&quot; &lt;* char '!'
&gt;&gt;&gt; parseRepl (greeting &lt;?&gt; [&quot;greeting&quot;]) &quot;hello world.&quot;
(line 1, column 12):
  unexpected &quot;.&quot;
  expected &quot;!&quot;
  &gt;hello world.
              ^
&gt;&gt;&gt; parseRepl (amend greeting &lt;?&gt; [&quot;greeting&quot;]) &quot;hello world.&quot;
(line 1, column 1):
  unexpected &quot;h&quot;
  expected greeting
  &gt;hello world.
   ^
-}</span></span><span>
</span><span id="line-250"></span><span id="local-6989586621679244196"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#amend"><span class="hs-identifier hs-type">amend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244196"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244196"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-251"></span><span id="amend"><span class="annot"><span class="annottext">amend :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amend"><span class="hs-identifier hs-var hs-var">amend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
forall a.
(Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_amend"><span class="hs-identifier hs-var">_amend</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#amendErr"><span class="hs-identifier hs-var">Internal.amendErr</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">--TODO: examples</span><span>
</span><span id="line-254"></span><span class="annot"><span class="hs-comment">{-|
This combinator adjusts any error messages generated by the given parser so that they
occur at the position recorded on entry to this combinator, but retains the original offset.

Similar to 'amend', but retains the original offset the error occurred at. This is known
as its /underlying offset/ as opposed to the visual /presentation offset/. To the reader, the
error messages appears as if no input was consumed, but for the purposes of error message merging
the error is still deeper. A key thing to note is that two errors can only merge if they are at
the same presentation /and/ underlying offsets: if they are not the deeper of the two /dominates/.

The ability for an error to still dominate others after partial amendment can be useful for allowing
it to avoid being lost when merging with errors that are deeper than the presentation offset but
shallower than the underlying.
-}</span></span><span>
</span><span id="line-268"></span><span id="local-6989586621679244198"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmend"><span class="hs-identifier hs-type">partialAmend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244198"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244198"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-269"></span><span id="partialAmend"><span class="annot"><span class="annottext">partialAmend :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmend"><span class="hs-identifier hs-var hs-var">partialAmend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
forall a.
(Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_amend"><span class="hs-identifier hs-var">_amend</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#partialAmendErr"><span class="hs-identifier hs-var">Internal.partialAmendErr</span></a></span><span>
</span><span id="line-270"></span><span>
</span><span id="line-271"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#_amend"><span class="hs-pragma hs-type">_amend</span></a></span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-272"></span><span id="local-6989586621679244019"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#_amend"><span class="hs-identifier hs-type">_amend</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.Errors.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244019"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244019"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-273"></span><span id="_amend"><span class="annot"><span class="annottext">_amend :: forall a.
(Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#_amend"><span class="hs-identifier hs-var hs-var">_amend</span></a></span></span><span> </span><span id="local-6989586621679244199"><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error
</span><a href="#local-6989586621679244199"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Internal.Parsec</span></a></span><span> </span><span id="local-6989586621679244200"><span class="annot"><span class="annottext">forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244200"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-274"></span><span>  </span><span class="annot"><span class="annottext">(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a.
(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-var">Internal.Parsec</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
 -&gt; Parsec a)
-&gt; (forall r.
    State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244201"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679244202"><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244202"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span id="local-6989586621679244203"><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244203"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-275"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621679244204"><span class="annot"><span class="annottext">origConsumed :: Word
</span><a href="#local-6989586621679244204"><span class="hs-identifier hs-var hs-var">origConsumed</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-276"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679244205"><span class="annot"><span class="annottext">origLine :: Word
</span><a href="#local-6989586621679244205"><span class="hs-identifier hs-var hs-var">origLine</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#line"><span class="hs-identifier hs-var">Internal.line</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679244206"><span class="annot"><span class="annottext">origCol :: Word
</span><a href="#local-6989586621679244206"><span class="hs-identifier hs-var hs-var">origCol</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#col"><span class="hs-identifier hs-var">Internal.col</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-278"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679244207"><span class="annot"><span class="annottext">origHints :: Hints
</span><a href="#local-6989586621679244207"><span class="hs-identifier hs-var hs-var">origHints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Hints
</span><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier hs-var">Internal.hints</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-279"></span><span>        </span><span class="hs-glyph">!</span><span id="local-6989586621679244208"><span class="annot"><span class="annottext">origHintsValidOffset :: Word
</span><a href="#local-6989586621679244208"><span class="hs-identifier hs-var hs-var">origHintsValidOffset</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#hintsValidOffset"><span class="hs-identifier hs-var">Internal.hintsValidOffset</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244200"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244201"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244202"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">((Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244209"><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244209"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span id="local-6989586621679244210"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244210"><span class="hs-identifier hs-var">st'</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244203"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Word -&gt; Word -&gt; Error -&gt; Error
</span><a href="#local-6989586621679244199"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244204"><span class="hs-identifier hs-var">origConsumed</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244205"><span class="hs-identifier hs-var">origLine</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244206"><span class="hs-identifier hs-var">origCol</span></a></span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244209"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>                                   </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244210"><span class="hs-identifier hs-var">st'</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hints"><span class="hs-identifier hs-var">Internal.hints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679244207"><span class="hs-identifier hs-type">origHints</span></a></span><span>
</span><span id="line-282"></span><span>                                       </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#hintsValidOffset"><span class="hs-identifier hs-var">Internal.hintsValidOffset</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679244208"><span class="hs-identifier hs-type">origHintsValidOffset</span></a></span><span> </span><span class="hs-special">}</span><span>
</span><span id="line-283"></span><span>
</span><span id="line-284"></span><span class="hs-comment">--TODO: examples</span><span>
</span><span id="line-285"></span><span class="annot"><span class="hs-comment">{-|
This combinator prevents the action of any enclosing 'amend' on the errors generated by the given
parser.

Sometimes, the error adjustments performed by 'amend' should only affect errors generated
within a certain part of a parser and not the whole thing; in this case, 'entrench' can be used
to protect sub-parsers from having their errors adjusted, providing a much more fine-grained
scope for error adjustment.
-}</span></span><span>
</span><span id="line-294"></span><span id="local-6989586621679244211"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#entrench"><span class="hs-identifier hs-type">entrench</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244211"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244211"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-295"></span><span id="entrench"><span class="annot"><span class="annottext">entrench :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#entrench"><span class="hs-identifier hs-var hs-var">entrench</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
forall a. (Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#adjustErr"><span class="hs-identifier hs-var">Internal.adjustErr</span></a></span><span> </span><span class="annot"><span class="annottext">Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#entrenchErr"><span class="hs-identifier hs-var">Internal.entrenchErr</span></a></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="annot"><span class="hs-comment">{-|
This combinator undoes the action of any 'entrench' combinators on the given parser.

Entrenchment is important for preventing the incorrect amendment of certain parts of sub-errors
for a parser, but it may be then undesireable to block further amendments from elsewhere in the
parser. This combinator can be used to cancel all entrenchment after the critical section has
passed.
-}</span></span><span>
</span><span id="line-305"></span><span id="local-6989586621679244212"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#dislodge"><span class="hs-identifier hs-type">dislodge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244212"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244212"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-306"></span><span id="dislodge"><span class="annot"><span class="annottext">dislodge :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodge"><span class="hs-identifier hs-var hs-var">dislodge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Parsec a -&gt; Parsec a
forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodgeBy"><span class="hs-identifier hs-var">dislodgeBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word
forall a. Bounded a =&gt; a
</span><span class="hs-identifier hs-var">maxBound</span></span><span>
</span><span id="line-307"></span><span>
</span><span id="line-308"></span><span class="annot"><span class="hs-comment">{-|
This combinator undoes the action of the given number of 'entrench' combinators on the given parser.

Entrenchment is important for preventing the incorrect amendment of certain parts of sub-errors
for a parser, but it may be then undesireable to block further amendments from elsewhere in the
parser. This combinator can be used to cancel all entrenchment after the critical section has
passed.
-}</span></span><span>
</span><span id="line-316"></span><span id="local-6989586621679244026"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#dislodgeBy"><span class="hs-identifier hs-type">dislodgeBy</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The number of 'entrench' combinators to undo</span></span><span>
</span><span id="line-317"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244026"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The parser containing the 'entrench' combinators</span></span><span>
</span><span id="line-318"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244026"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-319"></span><span id="dislodgeBy"><span class="annot"><span class="annottext">dislodgeBy :: forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodgeBy"><span class="hs-identifier hs-var hs-var">dislodgeBy</span></a></span></span><span> </span><span id="local-6989586621679244216"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244216"><span class="hs-identifier hs-var">by</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
forall a. (Error -&gt; Error) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#adjustErr"><span class="hs-identifier hs-var">Internal.adjustErr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#dislodgeErr"><span class="hs-identifier hs-var">Internal.dislodgeErr</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244216"><span class="hs-identifier hs-var">by</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-320"></span><span>
</span><span id="line-321"></span><span class="annot"><span class="hs-comment">{-|
This combinator first tries to amend the position of any error generated by the given parser,
and if the error was entrenched will dislodge it instead.
-}</span></span><span>
</span><span id="line-325"></span><span id="local-6989586621679244217"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodge"><span class="hs-identifier hs-type">amendThenDislodge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244217"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244217"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-326"></span><span id="amendThenDislodge"><span class="annot"><span class="annottext">amendThenDislodge :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodge"><span class="hs-identifier hs-var hs-var">amendThenDislodge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodge"><span class="hs-identifier hs-var">dislodge</span></a></span><span> </span><span class="annot"><span class="annottext">(Parsec a -&gt; Parsec a)
-&gt; (Parsec a -&gt; Parsec a) -&gt; Parsec a -&gt; Parsec a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amend"><span class="hs-identifier hs-var">amend</span></a></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="annot"><span class="hs-comment">{-|
This combinator first tries to amend the position of any error generated by the given parser,
and if the error was entrenched will dislodge it the given number of times instead.
-}</span></span><span>
</span><span id="line-332"></span><span id="local-6989586621679244219"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodgeBy"><span class="hs-identifier hs-type">amendThenDislodgeBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ The number of 'entrench' combinators to dislodge.</span></span><span>
</span><span id="line-333"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244219"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The parser to amend and dislodge.</span></span><span>
</span><span id="line-334"></span><span>                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244219"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-335"></span><span id="amendThenDislodgeBy"><span class="annot"><span class="annottext">amendThenDislodgeBy :: forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodgeBy"><span class="hs-identifier hs-var hs-var">amendThenDislodgeBy</span></a></span></span><span> </span><span id="local-6989586621679244220"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244220"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Parsec a -&gt; Parsec a
forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodgeBy"><span class="hs-identifier hs-var">dislodgeBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244220"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Parsec a -&gt; Parsec a)
-&gt; (Parsec a -&gt; Parsec a) -&gt; Parsec a -&gt; Parsec a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amend"><span class="hs-identifier hs-var">amend</span></a></span><span>
</span><span id="line-336"></span><span>
</span><span id="line-337"></span><span class="annot"><span class="hs-comment">{-|
This combinator first tries to partially amend the position of any error generated by the given parser,
and if the error was entrenched will dislodge it instead.
-}</span></span><span>
</span><span id="line-341"></span><span id="local-6989586621679244221"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmendThenDislodge"><span class="hs-identifier hs-type">partialAmendThenDislodge</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244221"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-342"></span><span id="partialAmendThenDislodge"><span class="annot"><span class="annottext">partialAmendThenDislodge :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmendThenDislodge"><span class="hs-identifier hs-var hs-var">partialAmendThenDislodge</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodge"><span class="hs-identifier hs-var">dislodge</span></a></span><span> </span><span class="annot"><span class="annottext">(Parsec a -&gt; Parsec a)
-&gt; (Parsec a -&gt; Parsec a) -&gt; Parsec a -&gt; Parsec a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmend"><span class="hs-identifier hs-var">partialAmend</span></a></span><span>
</span><span id="line-343"></span><span>
</span><span id="line-344"></span><span class="annot"><span class="hs-comment">{-|
This combinator first tries to partially amend the position of any error generated by the given parser,
and if the error was entrenched will dislodge it the given number of times instead.
-}</span></span><span>
</span><span id="line-348"></span><span id="local-6989586621679244222"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmendThenDislodgeBy"><span class="hs-identifier hs-type">partialAmendThenDislodgeBy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Word</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244222"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244222"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-349"></span><span id="partialAmendThenDislodgeBy"><span class="annot"><span class="annottext">partialAmendThenDislodgeBy :: forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmendThenDislodgeBy"><span class="hs-identifier hs-var hs-var">partialAmendThenDislodgeBy</span></a></span></span><span> </span><span id="local-6989586621679244223"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244223"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Parsec a -&gt; Parsec a
forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#dislodgeBy"><span class="hs-identifier hs-var">dislodgeBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244223"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">(Parsec a -&gt; Parsec a)
-&gt; (Parsec a -&gt; Parsec a) -&gt; Parsec a -&gt; Parsec a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#partialAmend"><span class="hs-identifier hs-var">partialAmend</span></a></span><span>
</span><span id="line-350"></span><span>
</span><span id="line-351"></span><span class="annot"><span class="hs-comment">{-|
This combinator marks any errors within the given parser as being /lexical errors/.

When an error is marked as a /lexical error/, it sets a flag within the error that is
passed to 'Text.Gigaparsec.Errors.ErrorBuilder.unexpectedToken': this
should be used to prevent @Lexer@-based token extraction from being performed on an error,
since lexing errors cannot be the result of unexpected tokens.
-}</span></span><span>
</span><span id="line-359"></span><span id="local-6989586621679244224"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#markAsToken"><span class="hs-identifier hs-type">markAsToken</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244224"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244224"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-360"></span><span id="markAsToken"><span class="annot"><span class="annottext">markAsToken :: forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#markAsToken"><span class="hs-identifier hs-var hs-var">markAsToken</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Internal.Parsec</span></a></span><span> </span><span id="local-6989586621679244225"><span class="annot"><span class="annottext">forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244225"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a.
(forall r.
 State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
</span><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-var">Internal.Parsec</span></a></span><span> </span><span class="annot"><span class="annottext">((forall r.
  State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
 -&gt; Parsec a)
-&gt; (forall r.
    State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244226"><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244226"><span class="hs-identifier hs-var">st</span></a></span></span><span> </span><span id="local-6989586621679244227"><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244227"><span class="hs-identifier hs-var">good</span></a></span></span><span> </span><span id="local-6989586621679244228"><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244228"><span class="hs-identifier hs-var">bad</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>  </span><span class="annot"><span class="annottext">State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall r.
State -&gt; (a -&gt; State -&gt; RT r) -&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
</span><a href="#local-6989586621679244225"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244226"><span class="hs-identifier hs-var">st</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244227"><span class="hs-identifier hs-var">good</span></a></span><span> </span><span class="annot"><span class="annottext">((Error -&gt; State -&gt; RT r) -&gt; RT r)
-&gt; (Error -&gt; State -&gt; RT r) -&gt; RT r
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679244229"><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244229"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Error -&gt; State -&gt; RT r
</span><a href="#local-6989586621679244228"><span class="hs-identifier hs-var">bad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; Error -&gt; Error
</span><a href="Text.Gigaparsec.Internal.Errors.html#setLexical"><span class="hs-identifier hs-var">Internal.setLexical</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">State -&gt; Word
</span><a href="Text.Gigaparsec.Internal.html#consumed"><span class="hs-identifier hs-var">Internal.consumed</span></a></span><span> </span><span class="annot"><span class="annottext">State
</span><a href="#local-6989586621679244226"><span class="hs-identifier hs-var">st</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Error
</span><a href="#local-6989586621679244229"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>
</span><span id="line-363"></span><span class="annot"><span class="hs-comment">{-|
This combinator changes the expected component of any errors generated by this parser.

This is just an alias for the 'label' combinator.
-}</span></span><span>
</span><span id="line-368"></span><span class="hs-pragma">{-# INLINE</span><span> </span><span class="hs-pragma">(</span><span class="hs-pragma">&lt;?&gt;</span><span class="hs-pragma">)</span><span> </span><span class="hs-pragma">#-}</span><span>
</span><span id="line-369"></span><span class="hs-keyword">infix</span><span> </span><span class="hs-number">0</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#%3C%3F%3E"><span class="hs-operator hs-type">&lt;?&gt;</span></a></span><span>
</span><span id="line-370"></span><span id="local-6989586621679244038"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#%3C%3F%3E"><span class="hs-operator hs-type">(&lt;?&gt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244038"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244038"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-371"></span><span id="%3C%3F%3E"><span class="annot"><span class="annottext">&lt;?&gt; :: forall a. Parsec a -&gt; Set String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#%3C%3F%3E"><span class="hs-operator hs-var hs-var">(&lt;?&gt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Set String -&gt; Parsec a -&gt; Parsec a)
-&gt; Parsec a -&gt; Set String -&gt; Parsec a
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Set String -&gt; Parsec a -&gt; Parsec a
forall a. Set String -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#label"><span class="hs-keyword hs-var">label</span></a></span><span>
</span><span id="line-372"></span><span>
</span><span id="line-373"></span><span class="hs-comment">-- should these be implemented with branch? probably not.</span><span>
</span><span id="line-374"></span><span class="annot"><span class="hs-comment">{-|
This combinator filters the result of this parser with the given predicate, 
generating an error with the given error generator if the function returned 'False'.

Behaves like 'Text.Gigaparsec.filterS', except the error message generated is fine-tuned with
respect to the parser's result and width of input consumed, using the 'ErrorGen'.

First, parse @p@. 
If it succeeds then take its result @x@ and apply it to the predicate @pred@. 

* If @pred x@ is true, then return @x@. 
* If @pred x@ is false, the combinator fails and produces an error message descrbied by the given 'ErrorGen'.

If @p@ failed, this combinator fails without using the given 'ErrorGen'.

@since 0.2.2.0
-}</span></span><span>
</span><span id="line-391"></span><span id="local-6989586621679244043"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier hs-type">filterSWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#ErrorGen"><span class="hs-identifier hs-type">ErrorGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244043"><span class="hs-identifier hs-type">a</span></a></span><span>  </span><span class="annot"><span class="hs-comment">-- ^ the generator for the error message when @p@ succeeds but @pred@ fails.</span></span><span>
</span><span id="line-392"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244043"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ @pred@, the predicate that is tested against the result of @p@</span></span><span>
</span><span id="line-393"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244043"><span class="hs-identifier hs-type">a</span></a></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to test</span></span><span>
</span><span id="line-394"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244043"><span class="hs-identifier hs-type">a</span></a></span></span><span>    </span><span class="annot"><span class="hs-comment">-- ^ a parser that returns the result of @p@ if it passes the predicate.</span></span><span>
</span><span id="line-395"></span><span id="filterSWith"><span class="annot"><span class="annottext">filterSWith :: forall a. ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier hs-var hs-var">filterSWith</span></a></span></span><span> </span><span id="local-6989586621679244235"><span class="annot"><span class="annottext">ErrorGen a
</span><a href="#local-6989586621679244235"><span class="hs-identifier hs-var">errGen</span></a></span></span><span> </span><span id="local-6989586621679244236"><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679244236"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679244237"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679244237"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Parsec a -&gt; Parsec a
forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodgeBy"><span class="hs-identifier hs-var">amendThenDislodgeBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Parsec a -&gt; Parsec a) -&gt; Parsec a -&gt; Parsec a
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec (a, Word)
forall a. Parsec a -&gt; Parsec (a, Word)
</span><a href="Text.Gigaparsec.Position.html#withWidth"><span class="hs-identifier hs-var">withWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#entrench"><span class="hs-identifier hs-var">entrench</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679244237"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parsec (a, Word) -&gt; ((a, Word) -&gt; Parsec a) -&gt; Parsec a
forall a b. Parsec a -&gt; (a -&gt; Parsec b) -&gt; Parsec b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679244238"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244238"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244239"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244239"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">a -&gt; Bool
</span><a href="#local-6989586621679244236"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244238"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">a -&gt; Parsec a
forall a. a -&gt; Parsec a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244238"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">ErrorGen a -&gt; a -&gt; Word -&gt; Parsec a
forall a b. ErrorGen a -&gt; a -&gt; Word -&gt; Parsec b
</span><a href="Text.Gigaparsec.Errors.ErrorGen.html#asErr"><span class="hs-identifier hs-var">ErrorGen.asErr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorGen a
</span><a href="#local-6989586621679244235"><span class="hs-identifier hs-var">errGen</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244238"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244239"><span class="hs-identifier hs-var">w</span></a></span><span>
</span><span id="line-397"></span><span>
</span><span id="line-398"></span><span class="annot"><span class="hs-comment">{-|
Filters the result of the given parser @p@ using a given function @f@, succeeding only if @pred@ returns @Nothing@.

First, parse @p@. 
If it succeeds then take its result @x@ and apply it to the predicate @pred@. 

* If @pred x@ is 'Nothing', then return @x@. 
* If @pred x@ is @'Just' reason@, the combinator fails, and produces a /vanilla/ error with the given @reason@.

If @p@ failed, this combinator fails in the same way.

This is useful for performing data validation, 
but where a definitive reason can be given for the failure. 
In this instance, the rest of the error message is generated as normal, 
with the expected and unexpected components still given, along with any other generated reasons.

@since 0.2.2.0
-}</span></span><span>
</span><span id="line-416"></span><span id="local-6989586621679244054"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#filterOut"><span class="hs-identifier hs-type">filterOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244054"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ @f@, the function that produces a reason for values we wish to filter out</span></span><span>
</span><span id="line-417"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244054"><span class="hs-identifier hs-type">a</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to filter</span></span><span>
</span><span id="line-418"></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244054"><span class="hs-identifier hs-type">a</span></a></span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ a parser that returns @x@, the result of @p@, only when @f x@ is 'Nothing'.</span></span><span>
</span><span id="line-419"></span><span id="filterOut"><span class="annot"><span class="annottext">filterOut :: forall a. (a -&gt; Maybe String) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#filterOut"><span class="hs-identifier hs-var hs-var">filterOut</span></a></span></span><span> </span><span id="local-6989586621679244241"><span class="annot"><span class="annottext">a -&gt; Maybe String
</span><a href="#local-6989586621679244241"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-420"></span><span>  </span><span class="annot"><span class="annottext">ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
forall a. ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier hs-var">filterSWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorGen a
forall a. ErrorGen a
</span><a href="Text.Gigaparsec.Errors.ErrorGen.html#vanillaGen"><span class="hs-identifier hs-var">vanillaGen</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#reason"><span class="hs-identifier hs-var">ErrorGen.reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679244241"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Bool) -&gt; (a -&gt; Maybe String) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe String
</span><a href="#local-6989586621679244241"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">{-|
This combinator filters the result of the given parser using the given partial-predicate, succeeding only when the predicate returns 'Nothing'.

First, run the given parser @p@. 
If it succeeds with result @x@, then apply the given partial-predicate @pred@:

* If @pred x@ is 'Nothing', the parser succeeds, returning @x@. 
* If @pred x@ is @'Just' msgs@, the parser fails, producing a /specialised/ error only consisting of the messages @msgs@.

This is useful for performing data validation, but where failure is not tied to the grammar 
but some other property of the results.

Where 'guardAgainst' shines, however, is in scenarios where the expected alternatives, 
or the unexpected component itself distracts from the cause of the error, or is irrelevant in some way. 
This might be because 'guardAgainst' is checking some property of the data that is possible to encode in the grammar, 
but otherwise impractical, either because it is hard to maintain or generates poor error messages for the user.

@since 0.2.2.0
-}</span></span><span>
</span><span id="line-441"></span><span class="hs-comment">-- FIXME: 0.3.0.0 change to NonEmptyList</span><span>
</span><span id="line-442"></span><span id="local-6989586621679244058"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#guardAgainst"><span class="hs-identifier hs-type">guardAgainst</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244058"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ @pred@, the predicate that is tested against the parser result, which also generates errors. </span></span><span>
</span><span id="line-443"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244058"><span class="hs-identifier hs-type">a</span></a></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to test against. </span></span><span>
</span><span id="line-444"></span><span>             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244058"><span class="hs-identifier hs-type">a</span></a></span></span><span>              </span><span class="annot"><span class="hs-comment">-- ^ a parser that returns the result of @p@ if it fails the @pred@.</span></span><span>
</span><span id="line-445"></span><span id="guardAgainst"><span class="annot"><span class="annottext">guardAgainst :: forall a. (a -&gt; Maybe [String]) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#guardAgainst"><span class="hs-identifier hs-var hs-var">guardAgainst</span></a></span></span><span> </span><span id="local-6989586621679244245"><span class="annot"><span class="annottext">a -&gt; Maybe [String]
</span><a href="#local-6989586621679244245"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-446"></span><span>  </span><span class="annot"><span class="annottext">ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
forall a. ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier hs-var">filterSWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorGen a
forall a. ErrorGen a
</span><a href="Text.Gigaparsec.Errors.ErrorGen.html#specializedGen"><span class="hs-identifier hs-var">specializedGen</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#messages"><span class="hs-identifier hs-var">ErrorGen.messages</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromJust</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621679244245"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe [String] -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe [String] -&gt; Bool) -&gt; (a -&gt; Maybe [String]) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe [String]
</span><a href="#local-6989586621679244245"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-447"></span><span>
</span><span id="line-448"></span><span class="annot"><span class="hs-comment">{-|
This combinator filters the result of the given parser using the given partial-predicate, 
succeeding only when the predicate is undefined.

First, run the given parser @p@. 
If it succeeds with result @x@, apply the given partial-predicate, @pred@:

* If @pred x@ is 'Nothing', the parser succeeds, returning x. 
* If @pred x@ is @'Just' lbl@, the parser fails using 'unexpected' with the label @lbl@.

If @p@ fails, then this combinator also fails.

This is useful for performing data validation where failure results in the entire token being unexpected. 
In this instance, the rest of the error message is generated as normal, with the expected components still given, 
along with any generated reasons.


@since 0.2.2.0
-}</span></span><span>
</span><span id="line-467"></span><span id="local-6989586621679244247"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWhen"><span class="hs-identifier hs-type">unexpectedWhen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244247"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ @pred@, the predicate that is tested against the parser result, which also generates errors. </span></span><span>
</span><span id="line-468"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244247"><span class="hs-identifier hs-type">a</span></a></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to test against. </span></span><span>
</span><span id="line-469"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244247"><span class="hs-identifier hs-type">a</span></a></span></span><span>            </span><span class="annot"><span class="hs-comment">-- ^ a parser that returns the result of @p@ if it fails the @pred@.</span></span><span>
</span><span id="line-470"></span><span id="unexpectedWhen"><span class="annot"><span class="annottext">unexpectedWhen :: forall a. (a -&gt; Maybe String) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWhen"><span class="hs-identifier hs-var hs-var">unexpectedWhen</span></a></span></span><span> </span><span id="local-6989586621679244250"><span class="annot"><span class="annottext">a -&gt; Maybe String
</span><a href="#local-6989586621679244250"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-471"></span><span>  </span><span class="annot"><span class="annottext">ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
forall a. ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier hs-var">filterSWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorGen a
forall a. ErrorGen a
</span><a href="Text.Gigaparsec.Errors.ErrorGen.html#vanillaGen"><span class="hs-identifier hs-var">vanillaGen</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#unexpected"><span class="hs-identifier hs-var">ErrorGen.unexpected</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#NamedItem"><span class="hs-identifier hs-type">ErrorGen.NamedItem</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromJust</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621679244250"><span class="hs-identifier hs-type">p</span></a></span><span> </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe String -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe String -&gt; Bool) -&gt; (a -&gt; Maybe String) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe String
</span><a href="#local-6989586621679244250"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-472"></span><span>
</span><span id="line-473"></span><span class="annot"><span class="hs-comment">{-|
This combinator filters the result of the given parser using the given partial-predicate, 
succeeding only when the predicate is undefined.

First, run the given parser @p@. 
If it succeeds with result @x@, apply the given partial-predicate, @pred@:

* If @pred x@ is 'Nothing', the parser succeeds, returning x. 
* If @pred x@ is @'Just' (lbl, rsn)@, the parser fails using the unexpected label @lbl@ and reason @rsn@.

If @p@ fails, then this combinator also fails.

This is useful for performing data validation where failure results in the entire token being unexpected. 
In this instance, the rest of the error message is generated as normal, with the expected components still given, 
along with any generated reasons.

@since 0.2.2.0
-}</span></span><span>
</span><span id="line-491"></span><span id="local-6989586621679244064"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWithReasonWhen"><span class="hs-identifier hs-type">unexpectedWithReasonWhen</span></a></span><span> </span><span>
</span><span id="line-492"></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244064"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ @pred@, the predicate that is tested against the parser result, which also generates errors.</span></span><span>
</span><span id="line-493"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244064"><span class="hs-identifier hs-type">a</span></a></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to test against.</span></span><span>
</span><span id="line-494"></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244064"><span class="hs-identifier hs-type">a</span></a></span></span><span>                      </span><span class="annot"><span class="hs-comment">-- ^ a parser that returns the result of @p@ if it fails the @pred@.</span></span><span>
</span><span id="line-495"></span><span id="unexpectedWithReasonWhen"><span class="annot"><span class="annottext">unexpectedWithReasonWhen :: forall a. (a -&gt; Maybe (String, String)) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#unexpectedWithReasonWhen"><span class="hs-identifier hs-var hs-var">unexpectedWithReasonWhen</span></a></span></span><span> </span><span id="local-6989586621679244257"><span class="annot"><span class="annottext">a -&gt; Maybe (String, String)
</span><a href="#local-6989586621679244257"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-496"></span><span>  </span><span class="annot"><span class="annottext">ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
forall a. ErrorGen a -&gt; (a -&gt; Bool) -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#filterSWith"><span class="hs-identifier hs-var">filterSWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorGen a
forall a. ErrorGen a
</span><a href="Text.Gigaparsec.Errors.ErrorGen.html#vanillaGen"><span class="hs-identifier hs-var">vanillaGen</span></a></span><span> </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#unexpected"><span class="hs-identifier hs-var">ErrorGen.unexpected</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#NamedItem"><span class="hs-identifier hs-type">ErrorGen.NamedItem</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fst</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">fromJust</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621679244257"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-497"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#reason"><span class="hs-identifier hs-var">ErrorGen.reason</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">fmap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">snd</span></span><span> </span><span class="annot"><span class="hs-operator hs-type">.</span></span><span> </span><span class="annot"><a href="#local-6989586621679244257"><span class="hs-identifier hs-type">p</span></a></span><span>
</span><span id="line-498"></span><span>                          </span><span class="hs-special">}</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (String, String) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><span class="hs-identifier hs-var">isNothing</span></span><span> </span><span class="annot"><span class="annottext">(Maybe (String, String) -&gt; Bool)
-&gt; (a -&gt; Maybe (String, String)) -&gt; a -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe (String, String)
</span><a href="#local-6989586621679244257"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-499"></span><span>
</span><span id="line-500"></span><span class="hs-comment">-- this is called mapFilter in Scala... there is no collect counterpart</span><span>
</span><span id="line-501"></span><span class="annot"><span class="hs-comment">{-|
This combinator applies a function @f@ to the result of a parser @p@: if it returns
@'Just' y@, @y@ is returned.
If @p@ succeeds but @f@ returns 'Nothing', then this combinator produces an error message according to the given 'ErrorGen'.

Behaves like 'Text.Gigaparsec.mapMaybeS' with a customised error message.

First, run the given parser @p@. 
If it succeeds, apply the function @f@ to the result @x@. 

* If @f x@ returns @'Just' y@, return @y@. 
* If @f x@ returns @'Nothing'@, the combinator fails and produces an error message descrbied by the given 'ErrorGen'.

If @p@ failed, this combinator fails without using the given 'ErrorGen'.

This is a more efficient way of performing a @filterS@ and @fmap@ at the same time.

@since 0.2.2.0
-}</span></span><span>
</span><span id="line-520"></span><span id="local-6989586621679244073"><span id="local-6989586621679244074"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#mapMaybeSWith"><span class="hs-identifier hs-type">mapMaybeSWith</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Errors.ErrorGen.html#ErrorGen"><span class="hs-identifier hs-type">ErrorGen</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244073"><span class="hs-identifier hs-type">a</span></a></span><span>     </span><span class="annot"><span class="hs-comment">-- ^ how to generate error messages based on the result of this parser.</span></span><span>
</span><span id="line-521"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244073"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679244074"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-comment">-- ^ @f@, the function used to both filter and transform the result of @p@.</span></span><span>
</span><span id="line-522"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244073"><span class="hs-identifier hs-type">a</span></a></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to filter</span></span><span>
</span><span id="line-523"></span><span>              </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244074"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>       </span><span class="annot"><span class="hs-comment">-- ^ a parser which returns the result of @p@ applied to @f@, if possible.</span></span><span>
</span><span id="line-524"></span><span id="mapMaybeSWith"><span class="annot"><span class="annottext">mapMaybeSWith :: forall a b. ErrorGen a -&gt; (a -&gt; Maybe b) -&gt; Parsec a -&gt; Parsec b
</span><a href="Text.Gigaparsec.Errors.Combinator.html#mapMaybeSWith"><span class="hs-identifier hs-var hs-var">mapMaybeSWith</span></a></span></span><span> </span><span id="local-6989586621679244262"><span class="annot"><span class="annottext">ErrorGen a
</span><a href="#local-6989586621679244262"><span class="hs-identifier hs-var">errGen</span></a></span></span><span> </span><span id="local-6989586621679244263"><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679244263"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679244264"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679244264"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Parsec b -&gt; Parsec b
forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodgeBy"><span class="hs-identifier hs-var">amendThenDislodgeBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Parsec b -&gt; Parsec b) -&gt; Parsec b -&gt; Parsec b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec (a, Word)
forall a. Parsec a -&gt; Parsec (a, Word)
</span><a href="Text.Gigaparsec.Position.html#withWidth"><span class="hs-identifier hs-var">withWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#entrench"><span class="hs-identifier hs-var">entrench</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679244264"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parsec (a, Word) -&gt; ((a, Word) -&gt; Parsec b) -&gt; Parsec b
forall a b. Parsec a -&gt; (a -&gt; Parsec b) -&gt; Parsec b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679244265"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244265"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244266"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244266"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-525"></span><span>  </span><span class="annot"><span class="annottext">Parsec b -&gt; (b -&gt; Parsec b) -&gt; Maybe b -&gt; Parsec b
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ErrorGen a -&gt; a -&gt; Word -&gt; Parsec b
forall a b. ErrorGen a -&gt; a -&gt; Word -&gt; Parsec b
</span><a href="Text.Gigaparsec.Errors.ErrorGen.html#asErr"><span class="hs-identifier hs-var">ErrorGen.asErr</span></a></span><span> </span><span class="annot"><span class="annottext">ErrorGen a
</span><a href="#local-6989586621679244262"><span class="hs-identifier hs-var">errGen</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244265"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244266"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; Parsec b
forall a. a -&gt; Parsec a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Maybe b
</span><a href="#local-6989586621679244263"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244265"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>
</span><span id="line-527"></span><span class="annot"><span class="hs-comment">{-|
This combinator conditionally transforms the result of this parser with a given function: 
if a @'Left' xs@ is returned, it generates an error with the messages @xs@; otherwise returns @y@ for the result @'Right' y@.

First, run the given parser @p@. 
If it succeeds, apply the function @f@ to the result @x@. 

* If @f x@ returns @'Right' y@, return @y@. 
* If @f x@ returns @'Left' xs@, the combinator fails with the error messages @xs@.

If @p@ failed, this combinator also fails.

@since 0.2.4.0
-}</span></span><span>
</span><span id="line-541"></span><span id="local-6989586621679244079"><span id="local-6989586621679244080"><span class="annot"><a href="Text.Gigaparsec.Errors.Combinator.html#mapEitherS"><span class="hs-identifier hs-type">mapEitherS</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679244079"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonEmpty</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">String</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679244080"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span>
</span><span id="line-542"></span><span>                        </span><span class="annot"><span class="hs-comment">-- ^ @f@, the predicate that is tested against the parser result.</span></span><span>
</span><span id="line-543"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244079"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ @p@, the parser to test against the predicate</span></span><span>
</span><span id="line-544"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679244080"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ a parser which returns the result of @p@ applied to @f@, if possible.</span></span><span>
</span><span id="line-545"></span><span id="mapEitherS"><span class="annot"><span class="annottext">mapEitherS :: forall a b.
(a -&gt; Either (NonEmpty String) b) -&gt; Parsec a -&gt; Parsec b
</span><a href="Text.Gigaparsec.Errors.Combinator.html#mapEitherS"><span class="hs-identifier hs-var hs-var">mapEitherS</span></a></span></span><span> </span><span id="local-6989586621679244270"><span class="annot"><span class="annottext">a -&gt; Either (NonEmpty String) b
</span><a href="#local-6989586621679244270"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679244271"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679244271"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Parsec b -&gt; Parsec b
forall a. Word -&gt; Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#amendThenDislodgeBy"><span class="hs-identifier hs-var">amendThenDislodgeBy</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">(Parsec b -&gt; Parsec b) -&gt; Parsec b -&gt; Parsec b
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec (a, Word)
forall a. Parsec a -&gt; Parsec (a, Word)
</span><a href="Text.Gigaparsec.Position.html#withWidth"><span class="hs-identifier hs-var">withWidth</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec a -&gt; Parsec a
forall a. Parsec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#entrench"><span class="hs-identifier hs-var">entrench</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679244271"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Parsec (a, Word) -&gt; ((a, Word) -&gt; Parsec b) -&gt; Parsec b
forall a b. Parsec a -&gt; (a -&gt; Parsec b) -&gt; Parsec b
forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><span class="hs-operator hs-var">&gt;&gt;=</span></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679244272"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244272"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679244273"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244273"><span class="hs-identifier hs-var">w</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-546"></span><span>  </span><span class="annot"><span class="annottext">(NonEmpty String -&gt; Parsec b)
-&gt; (b -&gt; Parsec b) -&gt; Either (NonEmpty String) b -&gt; Parsec b
forall a c b. (a -&gt; c) -&gt; (b -&gt; c) -&gt; Either a b -&gt; c
</span><span class="hs-identifier hs-var">either</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Word -&gt; NonEmpty String -&gt; Parsec b
forall a. Word -&gt; NonEmpty String -&gt; Parsec a
</span><a href="Text.Gigaparsec.Errors.Combinator.html#failWide"><span class="hs-identifier hs-var">failWide</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621679244273"><span class="hs-identifier hs-var">w</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">b -&gt; Parsec b
forall a. a -&gt; Parsec a
forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><span class="hs-identifier hs-var">pure</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Either (NonEmpty String) b
</span><a href="#local-6989586621679244270"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679244272"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-547"></span></pre></body></html>