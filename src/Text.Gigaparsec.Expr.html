<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE Safe #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{-|
Module      : Text.Gigaparsec.Expr
Description : This module contains various functionality relating to the parsing of expressions.
License     : BSD-3-Clause
Maintainer  : Jamie Willis, Gigaparsec Maintainers
Stability   : experimental

This module contains various functionality relating to the parsing of expressions.

It also includes functionality for constructing larger precedence tables, 
which may even vary the type of each layer in the table, 
allowing for strongly-typed expression parsing.
-}</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html"><span class="hs-identifier">Text.Gigaparsec.Expr</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Infix combinators</span></span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These are standalone Infix combinators. 
  They are useful for parsing the application of operators to values in many different configurations, including: 
  prefix, postfix, infix (left and right associated), and mixed fixity. 

  Although these combinators do have their uses, 
  they are overshadowed by the 'precedence' combinator, 
  which allows for the combining of multiple levels of infix-chaining in a clean and concise way.

  See &quot;Text.Gigaparsec.Expr.Infix&quot; and &quot;Text.Gigaparsec.Expr.Chain&quot; for more information on chaining combinators.
  -}</span></span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-comment">-- *** Binary Operator Chains</span></span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These combinators allow for the chaining together of values and binary operators in either left-, 
  right- or non-associative application.
  -}</span></span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#infixl1"><span class="hs-identifier">infixl1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#infixr1"><span class="hs-identifier">infixr1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#infixn1"><span class="hs-identifier">infixn1</span></a></span><span class="hs-special">,</span><span> </span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><span class="hs-comment">-- *** Unary Operator Chains</span></span><span>
</span><span id="line-36"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These combinators allow for the chaining together, and application, of multiple 
  prefix or postfix unary operators to a single value.
  -}</span></span><span>
</span><span id="line-40"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#prefix"><span class="hs-identifier">prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#postfix"><span class="hs-identifier">postfix</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Precedence Combinators</span></span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These combinators represent each of the different &quot;shapes&quot; of precedence combinator, 
  which takes a description of the precedence relations between various operators and constructs a parser for them.
  -}</span></span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#precedence"><span class="hs-identifier">precedence</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-47"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#precedence%27"><span class="hs-identifier">precedence'</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-48"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Precedence Layer Builders</span></span><span>
</span><span id="line-49"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These are used to construct an individual layer of a precedence table. 
  They all allow for the tying of a 'Fixity' to the parsers that inhabit the level, 
  which will have type @'Op' a b@ for some @a@ (the type of the layer below) and @b@ (the type of this layer). 
  'Op' uses existential types, so that the types of the parsers are only known when fixity itself is known. 
  
  The different objects represent different inter-layer relationships: 

    * are they the same type? Use 'ops'; 
    * is the layer below a subtype of this layer? use 'sops'; 
    * or none of the above? Use 'gops'!
  -}</span></span><span>
</span><span id="line-61"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#ops"><span class="hs-identifier">ops</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#sops"><span class="hs-identifier">sops</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#gops"><span class="hs-identifier">gops</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Fixity Description</span></span><span>
</span><span id="line-63"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These all describe the fixities and associativities of operators at a given level of the precedence table. 
  They are special because they each encode an 'Op' type, 
  which directs the type of the operators that are legal at the level (using existential types).
  -}</span></span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier">Fixity</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#InfixL"><span class="hs-identifier">InfixL</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#InfixR"><span class="hs-identifier">InfixR</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#InfixN"><span class="hs-identifier">InfixN</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prefix"><span class="hs-identifier">Prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Postfix"><span class="hs-identifier">Postfix</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-69"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Precedence Table Datatypes</span></span><span>
</span><span id="line-70"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  These are the parts that make up a precedence table
   (in particular, they are used for heterogeneous expression parsing, 
   with the types of each layer of the table vary from one another). 
   
  These are (mostly) not constructed directly,
  but are instead constructed via the use of the Ops builders or the :+ and +: methods.
  -}</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier">Op</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier">Op</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier">Prec</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Atom"><span class="hs-identifier">Atom</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Level"><span class="hs-identifier">Level</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#%3E%2B"><span class="hs-operator">(&gt;+)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#%2B%3C"><span class="hs-operator">(+&lt;)</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><span class="hs-comment">-- ** Module Re-export</span></span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  This should be removed at some point.
  -}</span></span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-keyword">module</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html"><span class="hs-identifier">Text.Gigaparsec.Expr</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-87"></span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.html"><span class="hs-identifier">Text.Gigaparsec</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier">Parsec</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-89"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Combinator.html"><span class="hs-identifier">Text.Gigaparsec.Combinator</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Combinator.html#choice"><span class="hs-identifier">choice</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html"><span class="hs-identifier">Text.Gigaparsec.Expr.Infix</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#infixl1"><span class="hs-identifier">infixl1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#infixr1"><span class="hs-identifier">infixr1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#infixn1"><span class="hs-identifier">infixn1</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#prefix"><span class="hs-identifier">prefix</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Infix.html#postfix"><span class="hs-identifier">postfix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Subtype.html"><span class="hs-identifier">Text.Gigaparsec.Expr.Subtype</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.Subtype.html#Subtype"><span class="hs-identifier">Subtype</span></a></span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.Subtype.html#upcast"><span class="hs-identifier">upcast</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldl'</span></span><span class="hs-special">)</span><span>
</span><span id="line-94"></span><span>
</span><span id="line-95"></span><span class="annot"><span class="hs-comment">{-|
Denotes the fixity and associativity of an operator. 

Importantly, it also specifies the types of the operations themselves.
-}</span></span><span>
</span><span id="line-100"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-101"></span><span class="hs-keyword">data</span><span> </span><span id="Fixity"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-var">Fixity</span></a></span></span><span> </span><span id="local-6989586621679246570"><span class="annot"><a href="#local-6989586621679246570"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679246571"><span class="annot"><a href="#local-6989586621679246571"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span id="local-6989586621679246572"><span class="annot"><a href="#local-6989586621679246572"><span class="hs-identifier hs-type">sig</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A left-associative binary Operator.</span></span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679246573"><span id="local-6989586621679246574"><span id="InfixL"><span class="annot"><a href="Text.Gigaparsec.Expr.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246574"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246574"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246573"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246574"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A right-associative binary Operator.</span></span><span>
</span><span id="line-105"></span><span>  </span><span id="local-6989586621679246575"><span id="local-6989586621679246576"><span id="InfixR"><span class="annot"><a href="Text.Gigaparsec.Expr.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246576"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246575"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246576"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246576"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A non-associative binary Operators.</span></span><span>
</span><span id="line-107"></span><span>  </span><span id="local-6989586621679246577"><span id="local-6989586621679246578"><span id="InfixN"><span class="annot"><a href="Text.Gigaparsec.Expr.html#InfixN"><span class="hs-identifier hs-var">InfixN</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246578"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246577"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246578"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A Unary prefix operator.</span></span><span>
</span><span id="line-109"></span><span>  </span><span id="local-6989586621679246579"><span id="local-6989586621679246580"><span id="Prefix"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246579"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246580"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246580"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246580"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-comment">-- | A Unary postfix operator.</span></span><span>
</span><span id="line-111"></span><span>  </span><span id="local-6989586621679246581"><span id="local-6989586621679246582"><span id="Postfix"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Postfix"><span class="hs-identifier hs-var">Postfix</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246581"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246582"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246582"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246582"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-112"></span><span>
</span><span id="line-113"></span><span class="annot"><span class="hs-comment">{-|
Describes a single layer of operators in the precedence tree.

The parameters are:

* @a@: the base tyep consumed by the operators.
* @b@: the type produced/consumed by the operators.
-}</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-122"></span><span class="hs-keyword">data</span><span> </span><span id="Op"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span id="local-6989586621679246529"><span class="annot"><a href="#local-6989586621679246529"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679246530"><span class="annot"><a href="#local-6989586621679246530"><span class="hs-identifier hs-type">b</span></a></span></span><span> </span><span>
</span><span id="line-123"></span><span>  </span><span class="annot"><span class="hs-comment">{-| 
  Describes the operators at a specific level in the precedence tree, 
  such that these ops consume @b@s, possibly @a@s and produce @b@s: 
  this depends on the 'Fixity' of the operators.
  -}</span></span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679246583"><span class="annot"><a href="#local-6989586621679246583"><span class="hs-identifier hs-type">sig</span></a></span></span><span class="hs-operator">.</span><span> </span><span id="Op"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-var">Op</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246529"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246530"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246583"><span class="hs-identifier hs-type">sig</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246529"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246530"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246583"><span class="hs-identifier hs-type">sig</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-129"></span><span>
</span><span id="line-130"></span><span class="annot"><span class="hs-comment">{-|
The base type for precedence tables.

The parameter @a@ is the type of structure produced by the list of levels.

For more complex expression parser types, 'Prec' describes the precedence table whilst preserving the intermediate structure between each level.

The base of the table will always be an 'Atom', and each layer built on top of the last using the 'Level' constructor.
-}</span></span><span>
</span><span id="line-139"></span><span class="hs-keyword">type</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-operator">*</span></span><span>
</span><span id="line-140"></span><span class="hs-keyword">data</span><span> </span><span id="Prec"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-var">Prec</span></a></span></span><span> </span><span id="local-6989586621679246584"><span class="annot"><a href="#local-6989586621679246584"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-141"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  Adds a new layer to this precedence table on the left, in a weakest-to-tightest ordering.

  This method associates to the left, so left-most applications are tighter binding 
  (closer to the atoms) than those to the right.

  It should not be mixed with '(+&lt;)', as this can be create a confusing and less predictable precedence table.
  -}</span></span><span>
</span><span id="line-149"></span><span>  </span><span id="local-6989586621679246585"><span id="local-6989586621679246586"><span id="Level"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Level"><span class="hs-identifier hs-var">Level</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246585"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246586"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246586"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="hs-comment">{-|
  The base of a precedence table.

  Forms the base of a precedence table, requiring at least one atom to be provided. This first atom will be parsed first.
  -}</span></span><span>
</span><span id="line-155"></span><span>  </span><span id="local-6989586621679246522"><span id="Atom"><span class="annot"><a href="Text.Gigaparsec.Expr.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246522"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246522"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><span class="hs-comment">{-|
Adds a new layer to this precedence table on the left, in a weakest-to-tightest ordering.
This is an alias for 'Level'.

This method associates to the left, so left-most applications are tighter binding 
(closer to the atoms) than those to the right.

It should not be mixed with '(+&lt;)', as this can be create a confusing and less predictable precedence table.
-}</span></span><span>
</span><span id="line-166"></span><span class="hs-keyword">infixl</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#%3E%2B"><span class="hs-operator hs-type">&gt;+</span></a></span><span>
</span><span id="line-167"></span><span id="local-6989586621679246477"><span id="local-6989586621679246479"><span class="annot"><a href="Text.Gigaparsec.Expr.html#%3E%2B"><span class="hs-operator hs-type">(&gt;+)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the lower precedence table.</span></span><span>
</span><span id="line-168"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246477"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246479"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the operators that make up the new level on the table.</span></span><span>
</span><span id="line-169"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246479"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ a new table that incorporates the operators and atoms in the given table, along with extra ops.</span></span><span>
</span><span id="line-170"></span><span id="%3E%2B"><span class="annot"><span class="annottext">&gt;+ :: forall a b. Prec a -&gt; Op a b -&gt; Prec b
</span><a href="Text.Gigaparsec.Expr.html#%3E%2B"><span class="hs-operator hs-var hs-var">(&gt;+)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prec a -&gt; Op a b -&gt; Prec b
forall a b. Prec a -&gt; Op a b -&gt; Prec b
</span><a href="Text.Gigaparsec.Expr.html#Level"><span class="hs-identifier hs-var">Level</span></a></span><span>
</span><span id="line-171"></span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">{-|
Adds a new layer to this precedence table on the right, in a tightest-to-weakest ordering.

This method associates to the right (with this table on the right!), 
so right-most applications are tighter binding (closer to the atoms) than those to the left. 

It should not be mixed with '(&gt;+)', as this can be create a confusing and less predictable precedence table.
-}</span></span><span>
</span><span id="line-181"></span><span class="hs-keyword">infixr</span><span> </span><span class="hs-number">5</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#%2B%3C"><span class="hs-operator hs-type">+&lt;</span></a></span><span>
</span><span id="line-182"></span><span id="local-6989586621679246483"><span id="local-6989586621679246484"><span class="annot"><a href="Text.Gigaparsec.Expr.html#%2B%3C"><span class="hs-operator hs-type">(+&lt;)</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246484"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the lower precedence table. </span></span><span>
</span><span id="line-183"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246483"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the operators that make up the new level on the table. </span></span><span>
</span><span id="line-184"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246484"><span class="hs-identifier hs-type">b</span></a></span></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ a new table that incorporates the operators and atoms in the given table, along with extra ops.</span></span><span>
</span><span id="line-185"></span><span id="%2B%3C"><span class="annot"><span class="annottext">+&lt; :: forall a b. Op a b -&gt; Prec a -&gt; Prec b
</span><a href="Text.Gigaparsec.Expr.html#%2B%3C"><span class="hs-operator hs-var hs-var">(+&lt;)</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Prec a -&gt; Op a b -&gt; Prec b) -&gt; Op a b -&gt; Prec a -&gt; Prec b
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">Prec a -&gt; Op a b -&gt; Prec b
forall a b. Prec a -&gt; Op a b -&gt; Prec b
</span><a href="Text.Gigaparsec.Expr.html#%3E%2B"><span class="hs-operator hs-var">(&gt;+)</span></a></span><span>
</span><span id="line-186"></span><span>
</span><span id="line-187"></span><span class="annot"><span class="hs-comment">{-|
Constructs a precedence parser.

This combinator builds an expression parser given a heterogeneous precedence table.

An expression parser will be formed by collapsing the given precedence table layer-by-layer. 
Since this table is heterogeneous, each level of the table produces a difference type, 
which is then consumed by the next level above.
-}</span></span><span>
</span><span id="line-196"></span><span id="local-6989586621679246490"><span class="annot"><a href="Text.Gigaparsec.Expr.html#precedence"><span class="hs-identifier hs-type">precedence</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Prec"><span class="hs-identifier hs-type">Prec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246490"><span class="hs-identifier hs-type">a</span></a></span><span>   </span><span class="annot"><span class="hs-comment">-- ^ the description of the heterogeneous table, where each level can vary in output and input types.</span></span><span>
</span><span id="line-197"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246490"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ an expression parser for the described precedence table.</span></span><span>
</span><span id="line-198"></span><span id="precedence"><span class="annot"><span class="annottext">precedence :: forall a. Prec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Expr.html#precedence"><span class="hs-identifier hs-var hs-var">precedence</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Atom"><span class="hs-identifier hs-type">Atom</span></a></span><span> </span><span id="local-6989586621679246588"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246588"><span class="hs-identifier hs-var">atom</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246588"><span class="hs-identifier hs-var">atom</span></a></span><span>
</span><span id="line-199"></span><span class="annot"><a href="Text.Gigaparsec.Expr.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Level"><span class="hs-identifier hs-type">Level</span></a></span><span> </span><span id="local-6989586621679246589"><span class="annot"><span class="annottext">Prec a
</span><a href="#local-6989586621679246589"><span class="hs-identifier hs-var">lvls</span></a></span></span><span> </span><span id="local-6989586621679246590"><span class="annot"><span class="annottext">Op a a
</span><a href="#local-6989586621679246590"><span class="hs-identifier hs-var">lvl</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Parsec a -&gt; Op a a -&gt; Parsec a
forall a b. Parsec a -&gt; Op a b -&gt; Parsec b
</span><a href="#local-6989586621679246591"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Prec a -&gt; Parsec a
forall a. Prec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Expr.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><span class="annottext">Prec a
</span><a href="#local-6989586621679246589"><span class="hs-identifier hs-var">lvls</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Op a a
</span><a href="#local-6989586621679246590"><span class="hs-identifier hs-var">lvl</span></a></span><span>
</span><span id="line-200"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span id="local-6989586621679246494"><span id="local-6989586621679246495"><span class="annot"><a href="#local-6989586621679246591"><span class="hs-identifier hs-type">con</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246494"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246495"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246495"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679246591"><span class="annot"><span class="annottext">con :: forall a b. Parsec a -&gt; Op a b -&gt; Parsec b
</span><a href="#local-6989586621679246591"><span class="hs-identifier hs-var hs-var">con</span></a></span></span><span> </span><span id="local-6989586621679246592"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246592"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="Text.Gigaparsec.Expr.html#InfixL"><span class="hs-identifier hs-var">InfixL</span></a></span><span> </span><span id="local-6989586621679246594"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246594"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679246595"><span class="annot"><span class="annottext">Parsec sig
</span><a href="#local-6989586621679246595"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Parsec a -&gt; Parsec (b -&gt; a -&gt; b) -&gt; Parsec b
forall a b.
(a -&gt; b) -&gt; Parsec a -&gt; Parsec (b -&gt; a -&gt; b) -&gt; Parsec b
</span><a href="Text.Gigaparsec.Expr.Infix.html#infixl1"><span class="hs-identifier hs-var">infixl1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246594"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246592"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec sig
Parsec (b -&gt; a -&gt; b)
</span><a href="#local-6989586621679246595"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-202"></span><span>        </span><span class="annot"><a href="#local-6989586621679246591"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span id="local-6989586621679246596"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246596"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="Text.Gigaparsec.Expr.html#InfixR"><span class="hs-identifier hs-var">InfixR</span></a></span><span> </span><span id="local-6989586621679246598"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246598"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679246599"><span class="annot"><span class="annottext">Parsec sig
</span><a href="#local-6989586621679246599"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Parsec a -&gt; Parsec (a -&gt; b -&gt; b) -&gt; Parsec b
forall a b.
(a -&gt; b) -&gt; Parsec a -&gt; Parsec (a -&gt; b -&gt; b) -&gt; Parsec b
</span><a href="Text.Gigaparsec.Expr.Infix.html#infixr1"><span class="hs-identifier hs-var">infixr1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246598"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246596"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec sig
Parsec (a -&gt; b -&gt; b)
</span><a href="#local-6989586621679246599"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-203"></span><span>        </span><span class="annot"><a href="#local-6989586621679246591"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span id="local-6989586621679246600"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246600"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="Text.Gigaparsec.Expr.html#InfixN"><span class="hs-identifier hs-var">InfixN</span></a></span><span> </span><span id="local-6989586621679246602"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246602"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679246603"><span class="annot"><span class="annottext">Parsec sig
</span><a href="#local-6989586621679246603"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Parsec a -&gt; Parsec (a -&gt; a -&gt; b) -&gt; Parsec b
forall a b.
(a -&gt; b) -&gt; Parsec a -&gt; Parsec (a -&gt; a -&gt; b) -&gt; Parsec b
</span><a href="Text.Gigaparsec.Expr.Infix.html#infixn1"><span class="hs-identifier hs-var">infixn1</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246602"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246600"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec sig
Parsec (a -&gt; a -&gt; b)
</span><a href="#local-6989586621679246603"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-204"></span><span>        </span><span class="annot"><a href="#local-6989586621679246591"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span id="local-6989586621679246604"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246604"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="Text.Gigaparsec.Expr.html#Prefix"><span class="hs-identifier hs-var">Prefix</span></a></span><span> </span><span id="local-6989586621679246606"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246606"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679246607"><span class="annot"><span class="annottext">Parsec sig
</span><a href="#local-6989586621679246607"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Parsec (b -&gt; b) -&gt; Parsec a -&gt; Parsec b
forall a b. (a -&gt; b) -&gt; Parsec (b -&gt; b) -&gt; Parsec a -&gt; Parsec b
</span><a href="Text.Gigaparsec.Expr.Infix.html#prefix"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246606"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec sig
Parsec (b -&gt; b)
</span><a href="#local-6989586621679246607"><span class="hs-identifier hs-var">op</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246604"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-205"></span><span>        </span><span class="annot"><a href="#local-6989586621679246591"><span class="hs-identifier hs-var">con</span></a></span><span> </span><span id="local-6989586621679246608"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246608"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="Text.Gigaparsec.Expr.html#Postfix"><span class="hs-identifier hs-var">Postfix</span></a></span><span> </span><span id="local-6989586621679246610"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246610"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span id="local-6989586621679246611"><span class="annot"><span class="annottext">Parsec sig
</span><a href="#local-6989586621679246611"><span class="hs-identifier hs-var">op</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(a -&gt; b) -&gt; Parsec a -&gt; Parsec (b -&gt; b) -&gt; Parsec b
forall a b. (a -&gt; b) -&gt; Parsec a -&gt; Parsec (b -&gt; b) -&gt; Parsec b
</span><a href="Text.Gigaparsec.Expr.Infix.html#postfix"><span class="hs-identifier hs-var">postfix</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246610"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246608"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec sig
Parsec (b -&gt; b)
</span><a href="#local-6989586621679246611"><span class="hs-identifier hs-var">op</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="annot"><span class="hs-comment">{-|
This combinator builds an expression parser given a collection of homogeneous atoms and operators.

An expression parser will be formed by treating the given parser as the base 'Atom', 
then each successive layer in the given list as another 'Level' in a tightest-to-weakest binding.
This means the last element of the given list will be at the top of the precedence table.

Each level must consume and produce the same type.
-}</span></span><span>
</span><span id="line-216"></span><span id="local-6989586621679246514"><span class="annot"><a href="Text.Gigaparsec.Expr.html#precedence%27"><span class="hs-identifier hs-type">precedence'</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The atom at the base of the table.</span></span><span>
</span><span id="line-217"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246514"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246514"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="annot"><span class="hs-comment">-- ^ The levels of operators, oredered tightest-to-weakest.</span></span><span>
</span><span id="line-218"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246514"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="annot"><span class="hs-comment">-- ^ An expression parser for the constructed precedence table.</span></span><span>
</span><span id="line-219"></span><span id="precedence%27"><span class="annot"><span class="annottext">precedence' :: forall a. Parsec a -&gt; [Op a a] -&gt; Parsec a
</span><a href="Text.Gigaparsec.Expr.html#precedence%27"><span class="hs-identifier hs-var hs-var">precedence'</span></a></span></span><span> </span><span id="local-6989586621679246614"><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246614"><span class="hs-identifier hs-var">atom</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Prec a -&gt; Parsec a
forall a. Prec a -&gt; Parsec a
</span><a href="Text.Gigaparsec.Expr.html#precedence"><span class="hs-identifier hs-var">precedence</span></a></span><span> </span><span class="annot"><span class="annottext">(Prec a -&gt; Parsec a)
-&gt; ([Op a a] -&gt; Prec a) -&gt; [Op a a] -&gt; Parsec a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(Prec a -&gt; Op a a -&gt; Prec a) -&gt; Prec a -&gt; [Op a a] -&gt; Prec a
forall b a. (b -&gt; a -&gt; b) -&gt; b -&gt; [a] -&gt; b
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="annot"><span class="annottext">Prec a -&gt; Op a a -&gt; Prec a
forall a b. Prec a -&gt; Op a b -&gt; Prec b
</span><a href="Text.Gigaparsec.Expr.html#%3E%2B"><span class="hs-operator hs-var">(&gt;+)</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Parsec a -&gt; Prec a
forall a. Parsec a -&gt; Prec a
</span><a href="Text.Gigaparsec.Expr.html#Atom"><span class="hs-identifier hs-var">Atom</span></a></span><span> </span><span class="annot"><span class="annottext">Parsec a
</span><a href="#local-6989586621679246614"><span class="hs-identifier hs-var">atom</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="annot"><span class="hs-comment">{-|
Constructs a single layer of operators @Op a b@, supporting fully heterogeneous precedence parsing.

This function builds an Ops object representing many operators found at the same precedence level, with a given fixity.

The operators found on the level constructed by this function are heterogeneous: 
the type of the level below may vary from the types of the values produced at this level. 
To make this work, a function must be provided that can transform the values from the 
layer below into the types generated by this layer.

The fixity describes the shape of the operators expected.
-}</span></span><span>
</span><span id="line-233"></span><span id="local-6989586621679246523"><span id="local-6989586621679246524"><span id="local-6989586621679246525"><span class="annot"><a href="Text.Gigaparsec.Expr.html#gops"><span class="hs-identifier hs-type">gops</span></a></span><span>  </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246524"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246525"><span class="hs-identifier hs-type">sig</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ the fixity of the operators described.</span></span><span>
</span><span id="line-234"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679246523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679246524"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span>       </span><span class="hs-comment">-- ^ the function that will convert @a@s to @b@s.</span><span>
</span><span id="line-235"></span><span>                        </span><span class="hs-comment">-- this will be at right of a left-assoc chain, left of a right-assoc chain, or the root of a prefix/postfix chain.</span><span>
</span><span id="line-236"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246525"><span class="hs-identifier hs-type">sig</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ The operators themselves, provided variadically.</span></span><span>
</span><span id="line-237"></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246523"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246524"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ A layer in the precedence table, containing the given parsers.</span></span><span>
</span><span id="line-238"></span><span id="gops"><span class="annot"><span class="annottext">gops :: forall a b sig.
Fixity a b sig -&gt; (a -&gt; b) -&gt; [Parsec sig] -&gt; Op a b
</span><a href="Text.Gigaparsec.Expr.html#gops"><span class="hs-identifier hs-var hs-var">gops</span></a></span></span><span> </span><span id="local-6989586621679246616"><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="#local-6989586621679246616"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span id="local-6989586621679246617"><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246617"><span class="hs-identifier hs-var">wrap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity a b sig -&gt; (a -&gt; b) -&gt; Parsec sig -&gt; Op a b
forall a b sig. Fixity a b sig -&gt; (a -&gt; b) -&gt; Parsec sig -&gt; Op a b
</span><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-var">Op</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="#local-6989586621679246616"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
</span><a href="#local-6989586621679246617"><span class="hs-identifier hs-var">wrap</span></a></span><span> </span><span class="annot"><span class="annottext">(Parsec sig -&gt; Op a b)
-&gt; ([Parsec sig] -&gt; Parsec sig) -&gt; [Parsec sig] -&gt; Op a b
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">[Parsec sig] -&gt; Parsec sig
forall a. [Parsec a] -&gt; Parsec a
</span><a href="Text.Gigaparsec.Combinator.html#choice"><span class="hs-identifier hs-var">choice</span></a></span><span>
</span><span id="line-239"></span><span>
</span><span id="line-240"></span><span class="annot"><span class="hs-comment">{-|
Constructs a single layer of operators in the precedence tree.
-}</span></span><span>
</span><span id="line-243"></span><span id="local-6989586621679246533"><span id="local-6989586621679246534"><span class="annot"><a href="Text.Gigaparsec.Expr.html#ops"><span class="hs-identifier hs-type">ops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246534"><span class="hs-identifier hs-type">sig</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The fixity of the layer to add.</span></span><span>
</span><span id="line-244"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246534"><span class="hs-identifier hs-type">sig</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ The parsers that can be run in this layer.</span></span><span>
</span><span id="line-245"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246533"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246533"><span class="hs-identifier hs-type">a</span></a></span></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ A layer in the precedence table, containing the given parsers.</span></span><span>
</span><span id="line-246"></span><span id="ops"><span class="annot"><span class="annottext">ops :: forall a sig. Fixity a a sig -&gt; [Parsec sig] -&gt; Op a a
</span><a href="Text.Gigaparsec.Expr.html#ops"><span class="hs-identifier hs-var hs-var">ops</span></a></span></span><span> </span><span id="local-6989586621679246618"><span class="annot"><span class="annottext">Fixity a a sig
</span><a href="#local-6989586621679246618"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity a a sig -&gt; (a -&gt; a) -&gt; [Parsec sig] -&gt; Op a a
forall a b sig.
Fixity a b sig -&gt; (a -&gt; b) -&gt; [Parsec sig] -&gt; Op a b
</span><a href="Text.Gigaparsec.Expr.html#gops"><span class="hs-identifier hs-var">gops</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a a sig
</span><a href="#local-6989586621679246618"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; a
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="annot"><span class="hs-comment">{-|
Constructs a single layer of operators in the precedence tree for values of @Op a b@, where @a@ is a 'Subtype' of @b@.
This provides support for subtyped heterogeneous precedence parsing.
-}</span></span><span>
</span><span id="line-252"></span><span id="local-6989586621679246538"><span id="local-6989586621679246539"><span id="local-6989586621679246541"><span class="annot"><a href="Text.Gigaparsec.Expr.html#sops"><span class="hs-identifier hs-type">sops</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.Subtype.html#Subtype"><span class="hs-identifier hs-type">Subtype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246538"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246539"><span class="hs-identifier hs-type">b</span></a></span><span>
</span><span id="line-253"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Fixity"><span class="hs-identifier hs-type">Fixity</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246538"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246539"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246541"><span class="hs-identifier hs-type">sig</span></a></span><span> </span><span class="annot"><span class="hs-comment">-- ^ The fixity of the layer to add.</span></span><span>
</span><span id="line-254"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Text.Gigaparsec.Internal.html#Parsec"><span class="hs-identifier hs-type">Parsec</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246541"><span class="hs-identifier hs-type">sig</span></a></span><span class="hs-special">]</span><span>   </span><span class="annot"><span class="hs-comment">-- ^ The parsers that can be run in this layer.</span></span><span>
</span><span id="line-255"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Text.Gigaparsec.Expr.html#Op"><span class="hs-identifier hs-type">Op</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246538"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679246539"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>         </span><span class="annot"><span class="hs-comment">-- ^ A layer in the precedence table, containing the given parsers.</span></span><span>
</span><span id="line-256"></span><span id="sops"><span class="annot"><span class="annottext">sops :: forall a b sig.
Subtype a b =&gt;
Fixity a b sig -&gt; [Parsec sig] -&gt; Op a b
</span><a href="Text.Gigaparsec.Expr.html#sops"><span class="hs-identifier hs-var hs-var">sops</span></a></span></span><span> </span><span id="local-6989586621679246622"><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="#local-6989586621679246622"><span class="hs-identifier hs-var">fixity</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Fixity a b sig -&gt; (a -&gt; b) -&gt; [Parsec sig] -&gt; Op a b
forall a b sig.
Fixity a b sig -&gt; (a -&gt; b) -&gt; [Parsec sig] -&gt; Op a b
</span><a href="Text.Gigaparsec.Expr.html#gops"><span class="hs-identifier hs-var">gops</span></a></span><span> </span><span class="annot"><span class="annottext">Fixity a b sig
</span><a href="#local-6989586621679246622"><span class="hs-identifier hs-var">fixity</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; b
forall sub sup. Subtype sub sup =&gt; sub -&gt; sup
</span><a href="Text.Gigaparsec.Expr.Subtype.html#upcast"><span class="hs-identifier hs-var">upcast</span></a></span><span>
</span><span id="line-257"></span></pre></body></html>